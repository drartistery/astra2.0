!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1ce33e92-1f6f-4123-85b0-bea1f1d252cd",e._sentryDebugIdIdentifier="sentry-dbid-1ce33e92-1f6f-4123-85b0-bea1f1d252cd")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"d5236f02"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3672],{1278:(e,n,t)=>{t.d(n,{A:()=>eC});var r,a=t(83846),i=t(12694),o=t(86105),s=t(88263),u=t(21462),l=t(66340),c=t(54319),d=t(86005),g=t(49069),p=t(94626),h=new p.k(function(e){var n=e.onFirstEdit;return g.sU.define({create:function(){return!1},update:function(e,t){return e||!t.docChanged||void 0===t.annotation(g.ZX.userEvent)?e:(null==n||n(),!0)}})}),m=t(43333),f=t(34591),v=t(61311),y=t(44916),b=t(55315),A=t(32507),w=t(93369),_=t(36640),U=t(54240),B=t(95139),S=t(17307),E=t(29445),Y=t(52784),C=t(38527),x=t(29935),I=t(82643),D=t(53231),R=t(38292),F=t(10429),P=t(94553),k=t(80762),T=t(32852);function O(e){var n,t,r,a=(n=({view:e.view}).view,t=(0,c.dI)(),{onUndo:function(e){null==n||n.dispatch({changes:{from:0,to:n.state.doc.length,insert:e}})},onEnhance:(r=(0,x._)(function(){var e,r,a,i;return(0,I.YH)(this,function(o){switch(o.label){case 0:return r=null!=(e=null==n?void 0:n.state.doc.toString())?e:"",[4,t.enhancePrompt(r)];case 1:if(!(a=o.sent()).ok||!(i=a.payload))throw Error("Failed to generate prompt");return null==n||n.dispatch({changes:{from:0,to:n.state.doc.length,insert:i.trimStart().trimEnd()}}),(0,D.u4)(D.AZ.AI_ENHANCE_PROMPT_USED,{action:"prompt_enhanced",originalPrompt:r,generatedPrompt:i}),[2,r]}})}),function(){return r.apply(this,arguments)})}),o=a.onUndo,l=a.onEnhance,d=(0,i._)((0,u.useState)(null),2),g=d[0],p=d[1],h=(0,i._)((0,u.useState)({type:"waiting"}),2),m=h[0],f=h[1];return(0,s.FD)(F.S,{row:!0,gap:4,align:"center",children:[null!==g?(0,s.Y)(R.K0,{alt:"Undo",disabled:e.loading,onClick:function(){p(null),o(g)},children:(0,s.Y)(T.A,{})}):null,(0,s.Y)(R.K0,{alt:"Improve prompt",tooltipContents:"Improve prompt",disabled:e.isDisabled||"waiting"!==m.type,onClick:function(){f({type:"generating"}),l().then(function(e){return p(e)}).finally(function(){return f({type:"waiting"})})},children:(0,s.Y)(function(){return"generating"===m.type?(0,s.Y)(k.A,{}):(0,s.Y)(P.A,{})},{})})]})}var L=t(75247),N=t(47104),q=t(65608),H=t(7894),z=t(47443),W=t(71192),M=t(77286),J=t(15036),j=t(483),K=t(51492),$=t(15811),G=t(11903),V=t(80446),Z=t(17844),Q=t(68264),X=t(57679),ee=t(22012),en=t(59318),et=t(1230),er=t(51244),ea=t(45263),ei=t(64583),eo=t(48521),es=t(33747),eu=t(36112),el=t(76126),ec=t(18870),ed=t(59655),eg=t(23072),ep=t(95072),eh=(0,ei.x)({root:[eo.wp.flex.growAndShrink(1),eo.wp.color.foregroundDimmer],label:[eo.wp.visuallyHidden],selectButton:[eo.wp.reset.button,eo.wp.borderRadius("default"),eo.wp.flex.row,eo.wp.rowWithGap(4),eo.wp.cursor.pointer,eo.wp.align.center,eo.wp.px(6),eo.wp.py(4),eo.wp.color.foregroundDimmer,eo.wp.fontSize(12),{'&[aria-expanded="true"] .chevron':{transform:"rotate(180deg)"},"&:hover":[eo.wp.color.foregroundDefault,eo.wp.backgroundColor.backgroundHigher]}],pooverSurface:[eo.wp.borderRadius(4),eo.wp.border({color:ea.LU.outlineDimmest})],buttonPrefixText:[eo.wp.color.foregroundDimmest]}),em=(0,ei.x)({root:[eo.wp.px(8),eo.wp.py(6),eo.wp.rowWithGap(8),eo.wp.align.start,eo.wp.justify.spaceBetween,eo.wp.cursor.pointer,eo.wp.hover({backgroundColor:ea.LU.backgroundHighest}),eo.wp.borderRadius("default")]}),ef=(0,ei.x)({root:em.root,rootSelected:[em.root,eo.wp.backgroundColor.backgroundHigher],content:[eo.wp.flex.grow(1)]}),ev={Auto:{icon:(0,s.Y)(ep.A,{}),description:"".concat(c.g$," will choose for you")},"Modern web app":(0,Z._)({icon:null},c.Wu[et.qf8.STACK_BLUEPRINT_FULLSTACK_JS]),"Interactive data app":(0,Z._)({icon:null},c.Wu[et.qf8.STACK_BLUEPRINT_STREAMLIT]),"3D game":(0,Z._)({icon:null},c.Wu[et.qf8.STACK_BLUEPRINT_GAMESTACK_JS]),"Web app (Python)":(0,Z._)({icon:null},c.Wu[et.qf8.STACK_BLUEPRINT_FLASK_VANILLA_JS])};function ey(e){var n=e.selectedOption,t=e.onChange,r=(0,er.a)();return(0,s.Y)(F.S,{css:eh.root,children:(0,s.FD)(Q.l6,{selectedKey:n,onOpenChange:function(e){e&&(0,D.u4)(D.AZ.START_WITH_AI_USED,{action:"stack_select_opened"})},onSelectionChange:function(e){(0,D.u4)(D.AZ.START_WITH_AI_USED,{action:"stack_selected",previousStack:n,newStack:e}),t(e)},children:[(0,s.Y)(es.J,{css:eh.label,children:"App type"}),(0,s.FD)(X.$,{css:eh.selectButton,children:[(0,s.Y)(eg.A,{}),(0,s.Y)("span",{css:eh.buttonPrefixText,children:"App type:"}),(0,s.Y)("span",{children:n}),(0,s.Y)(ed.A,{size:12,className:"chevron"})]}),(0,s.Y)(ee.A,{placement:r?"top":void 0,children:(0,s.Y)(eu.ui,{css:eh.pooverSurface,p:4,elevated:!0,children:(0,s.Y)(en.qF,{"aria-label":"App type",selectionMode:"single",children:Object.entries(ev).map(function(e){var t=(0,i._)(e,1)[0];return(0,s.Y)(en.nh,{id:t,"aria-label":t,children:(0,s.Y)(eb,{type:t,isSelected:n===t})},t)})})})})]})})}function eb(e){var n=e.type,t=e.isSelected,r=ev[n],a=r.icon,i=r.description;return(0,s.FD)(F.S,{css:t?ef.rootSelected:ef.root,children:[(0,s.FD)(F.S,{css:ef.content,pr:24,children:[(0,s.FD)(F.S,{row:!0,gap:6,align:"center",children:[(0,s.Y)(el.EY,{children:n}),a?(0,s.Y)(F.S,{children:a}):null]}),(0,s.Y)(F.S,{row:!0,gap:4,align:"center",children:(0,s.Y)(el.EY,{variant:"small",color:"dimmer",children:i})})]}),t?(0,s.Y)(ec.A,{color:ea.LU.greenStrongest}):null]})}var eA=t(973),ew=t(49045),e_=t(59172),eU=(0,ew.v)(["hoverBorderColor","focusedBorderColor"]),eB=eU.cssVars,eS=eU.styleTokens,eE=(0,ei.x)({wrapper:[eo.wp.position.relative,eo.wp.minHeight("fit-content"),{display:"grid",gridTemplate:"1fr / 1fr","& > *":{gridArea:"1 / 1"}}],surface:[eA.b.filledAndOutlined,eo.wp.borderRadius(6),eo.wp.flex.growAndShrink(1),eo.wp.p(4),{rowGap:ea.LU.space4,display:"flex",flexDirection:"column","&[disabled], &[aria-disabled]":{"& .cm-editor":{opacity:.5}},"@media (hover: hover)":{":not([disabled], [aria-disabled])":{cursor:"text"}},"&:hover:not([disabled], [aria-disabled]):hover":{borderColor:eS.hoverBorderColor},"&:focus-within:not([disabled], [aria-disabled])":{borderColor:eS.focusedBorderColor}}],inputWrapper:[eo.wp.flex.growAndShrink(1)],codemirror:[eo.wp.display.flex,eo.wp.flex.grow(1),eo.wp.overflow("auto"),eo.wp.maxHeight(300),{"& .cm-editor":[eo.wp.flex.grow(1)]}],attachments:[eo.wp.px(4),eo.wp.py(6)],primaryButtonGroup:[eo.wp.height(32)],submitButton:[eo.wp.borderRadius()],overlayBackground:[eo.wp.borderRadius(4),eo.wp.minHeight("100%"),eo.wp.height("fit-content"),{backgroundColor:ea.LU.backgroundDefault,zIndex:1,display:"flex",flexDirection:"column"}],overlayContent:[eo.wp.display.flex,eo.wp.flex.column,eo.wp.align.center,eo.wp.justify.center,eo.wp.p(24),eo.wp.height("100%"),eo.wp.flex.grow(1),{pointerEvents:"auto"}]}),eY=d.Lz.theme((r={"&":{flexGrow:1},"& .cm-content":{fontFamily:ea.LU.fontFamilyDefault}},(0,a._)(r,"& .".concat(A.Fb),{display:"none"}),(0,a._)(r,"& .cm-cursor",{borderLeftColor:ea.LU.foregroundDefault,borderLeftWidth:"1px"}),r));function eC(e){var n,t,r,d,g=(0,b.A)(),p=g.ref,A=g.view,x=(0,l.wR)(),I=(0,B.m5)(),D=null!=(n=e.status)?n:"composing",R=(0,v.Vn)(A,V.Im),P=(0,_.A)().showError,k=(0,V.hk)({text:null!=(t=e.placeholderText)?t:"Message Agentâ€¦"}),T=G.bZ.use(2e3),Z=(0,i._)((0,u.useState)("Auto"),2),Q=Z[0],X=Z[1],ee=(0,q.j)(e.persistenceKey,A),en=ee.persistPromptDraftCompartment,et=ee.clearPersistedPromptDraft,er=(0,z.e)(),ei=(0,j.s)(),eo=ei.attachments,es=ei.urlAttachments,el=ei.removeAttachment,ec=ei.addAttachments,ed=ei.addUrlAttachment,eg=ei.removeUrlAttachment,ep=ei.clearAttachments,eh=ei.isLoading,em=null!=(r=(0,v.Vn)(A,N.Wd))?r:[],ef=(0,u.useCallback)(function(e){A&&A.dispatch(A.state.update({changes:{from:0,to:A.state.doc.length,insert:e}}))},[A]),ev=(0,$.A)({addAttachments:ec}),eb=ev.isDraggedOver,eA=ev.drop,ew=R&&0===eo.length&&"composing"===D||"loading"===D||e.isSubmitDisabled||!!e.disabled||eh,eU=eh?"Please wait for files to finish uploading":e.submitDisabledReason,eS=e.onUpsell,eC=e.onSubmit,eI=e.disableClearOnSubmit,eD=(0,u.useCallback)(function(){if(ew||!A){e.isSubmitDisabled&&eS&&eS();return}var n=A.state.doc.toString();et(),eC(n,(0,o._)(eo).concat((0,o._)(es.map(function(e){return e.file}))),[],"Auto"===Q?void 0:(0,c.tK)(Q)),eI||(ep(),A.dispatch({effects:N.Ff.of(null)}),A.dispatch({changes:{from:0,to:A.state.doc.length}}))},[ew,eS,A,et,e.isSubmitDisabled,eC,eo,eI,ep,es,Q]),eR=(0,w.A)(eD),eF=ex.use({onSubmit:(0,u.useCallback)(function(){return eR.current()},[eR])}),eP=(0,H.F)({view:A,setPromptEditor:e.inputRef}),ek=L.U.use({addAttachments:ec,onAutoAttachedLargePaste:function(e){(0,J.pI)({action:"auto_attached_large_paste",fileSize:e})}}),eT=h.use({onFirstEdit:function(){var n;null==(n=e.onFirstEdit)||n.call(e)}}),eO=(0,U.S)([eA,eP],{breadcrumb:"client/workspace/components/Agent/Chat/InputBox/index.tsx:448"});return(0,s.FD)(F.S,{css:eE.wrapper,children:[(0,s.FD)(eu.ui,{css:eE.surface,innerRef:eO,gap:4,style:(d={borderColor:eb?ea.LU.accentPrimaryDefault:ea.LU.outlineDimmer},(0,a._)(d,eB.focusedBorderColor,ea.LU.accentPrimaryDefault),(0,a._)(d,eB.hoverBorderColor,ea.LU.accentPrimaryDefault),d),"aria-hidden":!e.overlay,"aria-disabled":!!e.disabled||void 0,inert:e.overlay?"true":void 0,onClick:function(e){e.target===e.currentTarget&&(null==A||A.focus())},children:[(0,s.FD)(F.S,{css:eE.inputWrapper,gap:4,children:[(0,s.Y)(E.A,{css:eE.attachments,detectedUrls:em.map(function(e){return(0,s.Y)(Y.A,{url:e,addUrlAttachment:ed,removeUrlAttachment:eg,onError:P},e)}),fileAttachments:eo.map(function(e){return(0,s.Y)(C.m1,{attachment:e,removeAttachment:el,getAttachmentTypeDisclaimer:(0,W.F)({aiName:(0,c.Nn)({capitalizeFirstChar:!0})})},e.path)})}),x?(0,s.Y)(F.S,{style:{minHeight:e.minHeight?"".concat(e.minHeight,"px"):void 0}}):(0,s.Y)(y.A,{"data-chromatic":"ignore",ref:p,css:eE.codemirror,style:{minHeight:e.minHeight?"".concat(e.minHeight,"px"):void 0,maxHeight:e.maxHeight?e.maxHeight:void 0},fontSize:14,readOnly:e.disabled,extensions:[eY,eF,ek,k,G.tP,T,en,f.r,m.N,eT,er?[]:N.fd],id:"ai-prompt-input","data-cy":"ai-prompt-input"})]}),(0,s.FD)(F.S,{row:!0,gap:4,css:eE.primaryButtonGroup,px:2,pb:2,justify:"space-between",align:"end",onClick:function(e){e.target===e.currentTarget&&(null==A||A.focus())},children:[(0,s.FD)(F.S,{row:!0,gap:I?12:4,align:"center",children:[(0,s.Y)(ey,{selectedOption:Q,onChange:X}),(0,s.Y)(eu.ui,{elevated:!0,children:(0,s.Y)(S.e,{disabled:e.disabled,status:D,addAttachments:ec})}),(0,s.Y)(M.A,{getCurrentText:function(){var e;return null!=(e=null==A?void 0:A.state.doc.toString())?e:""},onUpdateText:ef})]}),(0,s.FD)(F.S,{align:"center",row:!0,gap:8,children:[A?(0,s.Y)(eu.ui,{elevated:!0,children:(0,s.Y)(O,{isDisabled:e.disabled||null==R||R,view:A})}):null,I&&!e.renderSubmitButton?(0,s.Y)(K.J,{loading:"loading"===D,variant:"agent",alt:"composing"===D?"Send":"Loadingâ€¦",disabled:ew,onClick:eD,dataCy:"ai-prompt-submit"}):(0,s.Y)(eu.ui,{elevated:!0,css:eE.submitButton,children:(0,s.Y)(e_.m_,{isDisabled:!eU,tooltip:eU,children:e.renderSubmitButton({onSubmit:eD,disabled:ew})})})]})]})]}),e.overlay?(0,s.Y)(F.S,{css:eE.overlayBackground,children:(0,s.Y)(F.S,{css:eE.overlayContent,children:e.overlay})}):null]})}var ex=new p.k(function(e){var n=e.onSubmit,t=e.preventSubmitOnEnter;return d.Lz.domEventHandlers({keydown:function(e){!t&&("Enter"===e.key&&e.metaKey&&e.stopPropagation(),"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n()))}})})},17708:(e,n,t)=>{t.d(n,{jQ:()=>w,uJ:()=>b});var r=t(17844),a=t(12584),i=t(41114),o=t(86997),s=t(63893),u=t(19842);function l(){var e=(0,a._)(["\n  fragment StartWithAiOrgMetadata on Org {\n    id\n    name\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,a._)(["\n  fragment StartWithAiUsageBudget on UsageBasedBillingBudget {\n    id\n    hasReachedBudget\n  }\n"]);return c=function(){return e},e}function d(){var e=(0,a._)(["\n  fragment StartWithAiOrgUsageLimitAuthorization on OrgAuthorizations {\n    editUsageLimit {\n      isAuthorized\n      message\n    }\n  }\n"]);return d=function(){return e},e}function g(){var e=(0,a._)(["\n  query StartWithAi {\n    currentUser {\n      id\n      username\n      firstName\n      email\n      isVerified\n      ...CreateReplFormCurrentUser\n    }\n  }\n  ","\n"]);return g=function(){return e},e}function p(){var e=(0,a._)(["\n  query StartWithAiUsageLimits($orgId: String) {\n    currentUser {\n      id\n      usageBasedBillingBudget {\n        __typename\n        ... on UsageBasedBillingBudget {\n          ...StartWithAiUsageBudget\n        }\n        ... on Error {\n          message\n        }\n      }\n      usageBasedBillingAlerts {\n        ...EditUsageBasedBillingAlertsFormInitialConfig\n      }\n      org(orgId: $orgId) {\n        __typename\n        ... on Org {\n          ...StartWithAiOrgMetadata\n          authorizations {\n            ...StartWithAiOrgUsageLimitAuthorization\n          }\n          usageBasedBillingBudget {\n            __typename\n            ... on UsageBasedBillingBudget {\n              ...StartWithAiUsageBudget\n            }\n            ... on Error {\n              message\n            }\n          }\n          usageBasedBillingAlerts {\n            ...EditUsageBasedBillingAlertsFormInitialConfig\n          }\n        }\n        ... on Error {\n          message\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n  ","\n"]);return p=function(){return e},e}var h={},m=(0,i.J1)(l()),f=(0,i.J1)(c()),v=(0,i.J1)(d()),y=(0,i.J1)(g(),u._9);function b(e){var n=(0,r._)({},h,e);return o.I(y,n)}var A=(0,i.J1)(p(),f,s.B9,m,v);function w(e){var n=(0,r._)({},h,e);return o.I(A,n)}},55842:(e,n,t)=>{t.d(n,{a:()=>o,y:()=>i});var r=t(17708),a=t(34384);function i(){var e,n,t,i,o,s,u,l,c,d,g=(0,a.ET)().orgId,p=void 0!==g,h=(0,r.jQ)({variables:{orgId:g},context:{noBatch:!0},ssr:!1}),m=h.data,f=h.loading,v=h.error;if(f)return{status:"loading"};var y=!0;p?(e=null!=m&&!!m.currentUser&&"Org"===m.currentUser.org.__typename&&(null==(i=m.currentUser.org.usageBasedBillingBudget)?void 0:i.__typename)==="UsageBasedBillingBudget"&&m.currentUser.org.usageBasedBillingBudget.hasReachedBudget,y=null!=m&&!!m.currentUser&&"Org"===m.currentUser.org.__typename&&(null==(o=m.currentUser.org.authorizations)?void 0:o.__typename)==="OrgAuthorizations"&&m.currentUser.org.authorizations.editUsageLimit.isAuthorized,n=(null==m||null==(s=m.currentUser)?void 0:s.org.__typename)==="Org"?m.currentUser.org:void 0,t=(null==m||null==(u=m.currentUser)?void 0:u.org.__typename)==="Org"&&(null==(l=m.currentUser.org.usageBasedBillingAlerts)?void 0:l.__typename)==="UsageBasedBillingAlertsConfig"?m.currentUser.org.usageBasedBillingAlerts:void 0):(e=null!=m&&!!m.currentUser&&(null==(c=m.currentUser.usageBasedBillingBudget)?void 0:c.__typename)==="UsageBasedBillingBudget"&&m.currentUser.usageBasedBillingBudget.hasReachedBudget,t=(null==m||null==(d=m.currentUser)?void 0:d.usageBasedBillingAlerts.__typename)==="UsageBasedBillingAlertsConfig"?m.currentUser.usageBasedBillingAlerts:void 0);var b=v?"Failed to load usage data":void 0;return b?{status:"error",error:b}:{status:"success",hasReachedBudget:e,canEditUsageLimit:y,org:n,usageBasedBillingAlerts:t}}function o(e){return"CurrentUser"===e.__typename?"OrgAuthorizations"===e.personalOrgAuthorizations.__typename?e.personalOrgAuthorizations:void 0:"Org"===e.__typename?e.authorizations:void 0}},58870:(e,n,t)=>{t.d(n,{Q:()=>Z});var r=t(12694),a=t(88263),i=t(29542),o=t.n(i),s=t(71115),u=t(21462),l=t(54319),c=t(16564),d=t(79784),g=t(44959),p=t(47089),h=t(86020),m=t(17844),f=t(12584),v=t(41114),y=t(86997);function b(){var e=(0,f._)(["\n  query AgentInputReachedHardLimit($orgId: String) {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          endDate\n        }\n        ... on Error {\n          message\n        }\n      }\n      org(orgId: $orgId) {\n        ... on Org {\n          id\n          usageInterval {\n            ... on UsageInterval {\n              endDate\n            }\n            ... on Error {\n              message\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return b=function(){return e},e}var A={},w=(0,v.J1)(b()),_=t(64583),U=t(48521),B=t(46603),S=t(54087),E=t(76126),Y=t(10429),C=t(80762),x=t(86814),I=function(e){var n,t,r,i,o,s,u=e.onIncreaseBudget,l=e.canEditUsageLimit,c=e.orgId,d=void 0!==c,g=d&&!l,p=(n={variables:{orgId:c}},t=(0,m._)({},A,n),y.I(w,t)),h=p.data,f=p.loading,v=p.error;return(r=d?(null==h||null==(i=h.currentUser)?void 0:i.org.__typename)==="Org"&&"UsageInterval"===h.currentUser.org.usageInterval.__typename?h.currentUser.org.usageInterval.endDate:"":(null==h||null==(s=h.currentUser)||null==(o=s.usageInterval)?void 0:o.__typename)==="UsageInterval"?h.currentUser.usageInterval.endDate:"",f)?(0,a.Y)(Y.S,{css:F.loadingAndErrorWrapper,children:(0,a.Y)(C.A,{})}):v?(0,a.Y)(Y.S,{css:F.loadingAndErrorWrapper,children:(0,a.Y)(Y.S,{children:(0,a.Y)(S.N,{colorway:"red",text:"Something went wrong."})})}):(0,a.FD)(Y.S,{css:F.overlayContainer,gap:16,align:"center",justify:"center",children:[(0,a.FD)(Y.S,{css:F.overlayText,children:[(0,a.Y)(D,{isOrg:d}),(0,a.Y)(R,{isOrg:d,isOrgMemberWithoutEditPermission:g,endOfBillingPeriod:r})]}),g?null:(0,a.Y)(B.$n,{text:"Increase usage budget",onClick:u,iconLeft:(0,a.Y)(x.A,{}),colorway:"primary"})]})},D=function(e){var n=e.isOrg;return(0,a.Y)(E.EY,{css:F.overlayTitle,variant:"subheadDefault",children:n?"Your team has hit its monthly usage budget.":"You've hit your monthly usage budget."})},R=function(e){var n=e.isOrg,t=e.isOrgMemberWithoutEditPermission,r=e.endOfBillingPeriod,i=(0,g.A)(r),o=(0,p.A)(i)?" on ".concat((0,h.A)(i,"MMM do, hh:mm aaa")):"";return n?t?(0,a.FD)(E.EY,{variant:"small",children:["To continue using the Agent now, please contact your team admin to request an increase in the usage budget. Otherwise, your usage will reset",o," when the next billing period begins."]}):(0,a.FD)(E.EY,{variant:"small",children:["To continue using the Agent now, increase your budget. Otherwise, your team's usage will reset",o," when the next billing period begins."]}):(0,a.FD)(E.EY,{children:["To continue using the Agent now, increase your budget. Otherwise, your usage will reset",o," when the next billing period begins."]})},F=(0,_.x)({overlayContainer:[U.wp.maxWidth("100%")],overlayText:[U.wp.textAlign.center,U.wp.maxWidth(800),U.wp.colWithGap(8)],overlayTitle:[U.wp.fontWeight.bold],loadingAndErrorWrapper:[U.wp.display.flex,U.wp.flex.growAndShrink(1),U.wp.center,U.wp.minHeight(200)]}),P=t(29935),k=t(82643),T=t(6285),O=t(39999),L=t(49150),N=t(36112),q=t(90419),H=t(17826),z=(0,_.x)({ubbBannedContainer:[U.wp.width("85%")],buttonContainer:[U.wp.gap(16),U.wp.justify.spaceBetween,{"@media (max-width: 600px)":{flexDirection:"column"}}]});let W=function(e){var n=e.isSuspended,t=(0,r._)((0,u.useState)(!1),2),i=t[0],o=t[1];return(0,a.FD)(Y.S,{gap:12,align:"center",css:z.ubbBannedContainer,children:[(0,a.Y)(E.EY,{variant:"subheadDefault",children:n?"Your account has been temporarily suspended due to a failed payment":"You have a failed payment. Please update your payment method to continue using Agent."}),(0,a.Y)(E.EY,{children:"If you have already updated your payment method, please wait a few minutes and refresh the page."}),(0,a.Y)(N.ui,{elevated:!0,children:(0,a.FD)(Y.S,{row:!0,css:z.buttonContainer,children:[(0,a.Y)(Y.S,{gap:8,children:(0,a.Y)(O.v,{iconLeft:(0,a.Y)(H.A,{}),text:"View and pay invoices",href:"/orb-customer-portal",target:"_blank"})}),(0,a.Y)(Y.S,{gap:8,children:(0,a.Y)(B.$n,{iconLeft:(0,a.Y)(q.A,{}),text:"Update payment method",colorway:"primary",onClick:function(){return o(!0)}})})]})}),(0,a.Y)(L.a,{isOpen:i,onRequestClose:function(){return o(!1)},children:(0,a.Y)(T.k,{onDone:function(){o(!1)},onBack:(0,P._)(function(){return(0,k.YH)(this,function(e){return[2,o(!1)]})})})})]})};var M=t(66077),J=t(65298),j=t(50051),K=t(75176),$=t(61627),G=t(42627),V=t(8789);function Z(e){var n=e.agentAccessDeniedReason,t=e.owner,i=e.usageInfo,g=(0,r._)((0,u.useState)(!1),2),p=g[0],h=g[1],m=(0,s.useRouter)();if(n===M.F.BudgetExceeded)return(0,a.FD)(a.FK,{children:[(0,a.Y)(I,{orgId:"Org"===t.__typename?t.id:void 0,canEditUsageLimit:"success"===i.status&&i.canEditUsageLimit,onIncreaseBudget:function(){return h(!0)}}),(0,a.Y)(L.a,{isOpen:p,onRequestClose:function(){return h(!1)},children:(0,a.Y)($.j,{org:"success"===i.status?i.org:void 0,initialSettings:"success"===i.status?i.usageBasedBillingAlerts:void 0,onDone:function(){return h(!1)}})})]});if(n===M.F.FreeAgentCheckpointQuotaExceeded)return(0,a.FD)(Y.S,{gap:12,align:"center",children:[(0,a.Y)(G.A,{size:32}),(0,a.Y)(E.EY,{variant:"subheadDefault",children:"You've used all your free Agent checkpoints."}),(0,a.Y)(K.A,{context:"agent_freemium_quota",colorway:"brand",variant:"default",highlightUpsell:"agent",text:"Upgrade to ".concat(d.en," to continue using ").concat(l.g$)})]});if(n===M.F.ErrorDeterminingBudget)return(0,a.Y)(Y.S,{children:(0,a.Y)(Y.S,{children:(0,a.Y)(S.N,{colorway:"red",text:"Error determining remaining budget. Please try again later."})})});if(n===M.F.AgentKillswitch)return(0,a.Y)(Y.S,{children:(0,a.Y)(S.N,{colorway:"red",text:"This feature is currently unavailable. Please try again later."})});if(n===M.F.PaymentDelinquent)return(0,a.Y)(W,{isSuspended:!1});if(n===M.F.FreeReplLimitExceeded)return(0,a.FD)(Y.S,{gap:12,align:"center",children:[(0,a.Y)(V.A,{size:32}),(0,a.Y)(E.EY,{variant:"subheadDefault",children:"You've hit your limit of free Apps"}),(0,a.Y)(K.A,{context:"repl_limit_upsell",colorway:"brand",variant:"default",highlightUpsell:"replLimit",text:"Upgrade to ".concat(d.en," for unlimited Apps")})]});if(n===M.F.EmailVerificationRequired)return(0,a.Y)(J.A,{onEmailVerified:function(){m.reload()}});if(n===M.F.FreemiumTemporarilyUnavailable)return(0,a.FD)(Y.S,{gap:12,align:"center",children:[(0,a.FD)(E.EY,{variant:"subheadDefault",children:[l.g$," is currently experiencing high demand and is temporarily unavailable for ",d.Lm," plan users."]}),(0,a.FD)(E.EY,{children:["Please try again later, or upgrade to ",d.en," for immediate access."]}),(0,a.Y)(K.A,{context:"agent_freemium_quota",colorway:"brand",variant:"default",highlightUpsell:"agent",text:"Upgrade to ".concat(d.en," to continue using ").concat(l.g$)})]});if(n===M.F.NoReplCreationPermissions)return(0,a.Y)(Y.S,{children:(0,a.Y)(S.N,{colorway:"warning",text:"You do not have permission to create an app"})});if(n===M.F.UserUBBBanned)return(0,a.Y)(W,{isSuspended:!0});if(n===M.F.RequiresPaymentMethod){var f="Org"===t.__typename?"".concat((0,j.EG)({slug:t.slug}).settings.href,"?tab=billing"):"/account#billing";return(0,a.Y)(Y.S,{gap:12,align:"center",children:(0,a.Y)(S.N,{colorway:"warning",text:(0,a.FD)(E.EY,{children:["You must ",(0,a.Y)(o(),{href:f,children:"add a payment method"})," to continue using ",l.g$]})})})}(0,c.A)(n)}},59756:(e,n,t)=>{t.d(n,{u9:()=>g,Pz:()=>c});var r=t(29935),a=t(82643),i=function(){var e=(0,r._)(function(e){var n,t,r;return(0,a.YH)(this,function(a){return n=e.dbName,t=e.version,r=e.onUpgrade,[2,new Promise(function(e,a){var i=indexedDB.open(n,t);i.onerror=function(){var e;return a(Error("Failed to open database: ".concat(null==(e=i.error)?void 0:e.message)))},i.onsuccess=function(){return e(i.result)},r&&(i.onupgradeneeded=function(e){var n=e.target;n instanceof IDBOpenDBRequest&&n.result?r(n.result):a(Error("Invalid target during upgrade."))})})]})});return function(n){return e.apply(this,arguments)}}(),o=function(){var e=(0,r._)(function(e){var n,t,r,i;return(0,a.YH)(this,function(a){return n=e.db,t=e.storeName,r=e.mode,i=e.operation,[2,new Promise(function(e,a){if(!n.objectStoreNames.contains(t))return a(Error('Object store "'.concat(t,'" does not exist in the database.')));var o=n.transaction([t],r),s=i(o.objectStore(t));s.onsuccess=function(){return e(s.result)},s.onerror=function(){var e;return a(Error("Transaction error: ".concat(null==(e=s.error)?void 0:e.message)))},o.onabort=function(){return a(Error("Transaction was aborted."))},o.onerror=function(){return a(Error("Transaction encountered an error."))}})]})});return function(n){return e.apply(this,arguments)}}(),s="LandingPageAgentAttachments",u=null,l=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){return u?[2,u]:[2,u=i({dbName:"ReplitAgentAttachments",version:1,onUpgrade:function(e){e.objectStoreNames.contains(s)||e.createObjectStore(s,{keyPath:"id",autoIncrement:!0})}})]})});return function(){return e.apply(this,arguments)}}(),c=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:var n;return[2,o({db:(n={db:e.sent(),storeName:s}).db,storeName:n.storeName,mode:"readonly",operation:function(e){return e.getAll()}})]}})});return function(){return e.apply(this,arguments)}}(),d=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return[4,l()];case 1:var n;return[2,o({db:(n={db:e.sent(),storeName:s}).db,storeName:n.storeName,mode:"readwrite",operation:function(e){return e.clear()}})]}})});return function(){return e.apply(this,arguments)}}(),g=function(){var e=(0,r._)(function(){return(0,a.YH)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,d()];case 1:return e.sent(),[3,3];case 2:return e.sent(),[2];case 3:return[2]}})});return function(){return e.apply(this,arguments)}}()},66077:(e,n,t)=>{t.d(n,{F:()=>m,H:()=>f});var r=t(35084),a=t(55842),i=t(37123),o=t(5504),s=t(17844),u=t(12584),l=t(41114),c=t(86997);function d(){var e=(0,u._)(["\n  query IsUserUBBBanned {\n    currentUser {\n      id\n      isUBBBanned\n    }\n  }\n"]);return d=function(){return e},e}var g={},p=(0,l.J1)(d()),h=t(44996),m=function(e){return e.AgentKillswitch="Agent killswitch",e.ErrorDeterminingBudget="Error determining budget",e.BudgetExceeded="Budget exceeded",e.EmailVerificationRequired="Email verification required",e.FreeAgentCheckpointQuotaExceeded="Free Agent checkpoint quota exceeded",e.FreeReplLimitExceeded="Free Repl limit exceeded",e.FreemiumTemporarilyUnavailable="Freemium temporarily unavailable",e.NoReplCreationPermissions="No Repl creation permissions",e.UserUBBBanned="User is UBB Banned",e.RequiresPaymentMethod="Requires payment method",e.PaymentDelinquent="Failed payment. Update payment method to continue using Agent.",e}({});function f(e,n){var t,u,l,d,m,f,v=(0,h.i)(),y=v.agentCheckpoints,b=v.loading,A=(0,a.a)(e),w=(d=(t=(0,s._)({},g,void 0),l=c.I(p,t)).data,m=l.loading,f=l.refetch,{loading:m,isUserUBBBanned:null==d||null==(u=d.currentUser)?void 0:u.isUBBBanned,refetchBanStatus:f}),_=w.loading,U=w.isUserUBBBanned,B=(0,i.g)(),S=(0,o._P)({controlName:"flag-killswitch-agent"}),E=(0,o._P)({controlName:"flag-freemium-ai-load-shedder"}),Y="CurrentUser"===e.__typename&&!e.isSubscribed,C="Org"===e.__typename&&!e.authorizations.createPrivateRepl.isAuthorized&&!e.authorizations.createPublicRepl.isAuthorized;return!A||b||"loading"===n.status||"loading"===B.type||_?{loading:!0,hasAccess:!1}:S?{loading:!1,hasAccess:!1,accessDeniedReason:"Agent killswitch"}:U&&"Org"!==e.__typename?{loading:!1,hasAccess:!1,accessDeniedReason:"User is UBB Banned"}:"error"===n.status?{loading:!1,hasAccess:!1,accessDeniedReason:"Error determining budget"}:A.paidAgent.isAuthorized||A.paidAgent.code!==r.JB.InsufficientBudget?A.paidAgent.isAuthorized||A.freeAgent.isAuthorized||!C?A.freeAgent.isAuthorized||A.freeAgent.code!==r.JB.RequiresEmailVerification?!Y||(null==y?void 0:y.isUnderQuota)?"data"===B.type&&B.shouldBlockReplForm?{loading:!1,hasAccess:!1,accessDeniedReason:"Free Repl limit exceeded"}:E&&Y?{loading:!1,hasAccess:!1,accessDeniedReason:"Freemium temporarily unavailable"}:A.paidAgent.code===r.JB.RequiresPaymentMethod?{loading:!1,hasAccess:!1,accessDeniedReason:"Requires payment method"}:A.paidAgent.code===r.JB.PaymentDelinquent?{loading:!1,hasAccess:!1,accessDeniedReason:"Failed payment. Update payment method to continue using Agent."}:{loading:!1,hasAccess:!0}:{loading:!1,hasAccess:!1,accessDeniedReason:"Free Agent checkpoint quota exceeded"}:{loading:!1,hasAccess:!1,accessDeniedReason:"Email verification required"}:{loading:!1,hasAccess:!1,accessDeniedReason:"No Repl creation permissions"}:{loading:!1,hasAccess:!1,accessDeniedReason:"Budget exceeded"}}},94372:(e,n,t)=>{t.d(n,{M:()=>M});var r=t(29935),a=t(17844),i=t(93629),o=t(12694),s=t(82643),u=t(71115),l=t(21462),c=t(12584),d=t(41114),g=t(50175),p=t(86997),h=t(66112),m=t(40235);function f(){var e=(0,c._)(["\n  mutation CreateAgentReplCreateRepl($input: CreateReplInput!) {\n    createRepl(input: $input, isTitleAutoGenerated: false) {\n      ... on Repl {\n        id\n        url\n        isPrivate\n        nextPagePathname\n        origin {\n          id\n          isOwner\n        }\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n        ...CrosisContextRepl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function v(){var e=(0,c._)(["\n  query CreateAgentReplCurrentUser {\n    currentUser {\n      id\n      isStaff: hasRole(role: REPLIT_STAFF)\n      fullName\n      username\n      ...CrosisContextCurrentUser\n      personalOrgAuthorizations {\n        ...CreateReplAuthorizations\n      }\n      replCount {\n        ... on ReplCount {\n          count\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return v=function(){return e},e}var y={},b=(0,d.J1)(f(),h.c),A=(0,d.J1)(v(),h.N,m.Ev),w=t(90629);function _(){var e=(0,c._)(["\n  mutation GenerateAgentReplIcon($prompt: String!, $replId: String!) {\n    generateReplIcon(input: { prompt: $prompt, replId: $replId }) {\n      ... on GenerateReplIconResult {\n        repl {\n          id\n          iconUrl\n        }\n      }\n    }\n  }\n"]);return _=function(){return e},e}var U={},B=(0,d.J1)(_()),S=t(1230),E=t(54319),Y=t(10293),C=t(5504),x=t(95139),I=t(53231),D=t(15036),R=t(36640),F=t(59756),P=t(42745),k=t(25804),T=t(33593),O=t(69549),L=t(70079),N=t(55903),q=t(76139),H=t(39391),z=t(3299),W=t(74108);function M(e){var n,t,c,d,h,m,f,v,_,q,H,z,M,j,K,$,G,V=e.currentUser,Z=(0,o._)((0,l.useState)("idle"),2),Q=Z[0],X=Z[1],ee=(0,k.pE)("folderId","string"),en=(0,x.m6)(),et=(0,R.A)().showError,er=(0,o._)((m=(0,a._)({},y,void 0),g.n(b,m)),1)[0],ea=(c=(t=(n=(0,a._)({},y,void 0),p.I(A,n))).data,d=t.error,h=t.loading,d?{loading:!1,currentUser:null,errorCode:500}:(null==c?void 0:c.currentUser)?{loading:!1,currentUser:c.currentUser,errorCode:null}:h?{loading:!0,currentUser:null,errorCode:null}:{loading:!1,currentUser:null,errorCode:403}).currentUser,ei=(0,N.L)(),eo=(0,u.useRouter)(),es=(0,T.A)(),eu=(0,C._P)({controlName:"flag-killswitch-agent"}),el=(0,C._P)({controlName:"flag-agent-onboarding-ws"}),ec=function(e){X("idle"),et(e.message),w.v4(function(n){n.setTag("start-with-ai",!0),w.Cp(e)})},ed=(0,o._)((0,l.useState)("disconnected"),2),eg=ed[0],ep=ed[1],eh=(v=(f={currentUserUsername:V.username,currentUserEmail:V.email,currentUserTimeCreated:V.timeCreated,updatePromptConnectionStatus:function(e){ep(e)}}).currentUserUsername,_=f.currentUserEmail,q=f.currentUserTimeCreated,H=f.updatePromptConnectionStatus,z=(0,C._P)({controlName:"flag-repl-creation-slack-bot-events"}),M=(0,x.m6)(),j=(0,r._)(function(e){var n,t,a,i,o,u,l,c,d,g,p,h,m,f;return(0,s.YH)(this,function(y){switch(y.label){case 0:return n=e.prompt,t=e.uploadedFiles,a=e.attachedUrls,i=e.requestedStackBlueprint,o=e.replId,u=e.currentUserId,l=e.orgId,c=(0,S.hVx)({currentUserId:u}),(d=new S.ZnQ({clientId:c,serverId:E.wV,getEndpoint:(0,r._)(function(){var e,n;return(0,s.YH)(this,function(t){switch(t.label){case 0:return[4,(0,E.j2)(o,c,l)];case 1:return e=t.sent(),(n=new URL((0,E.qK)())).searchParams.set("auth_token",e),[2,n]}})}),onProtocolError:function(e){throw Error("Failed to send agent prompt. Protocol error: ".concat(e.message))},onRetriesExceeded:function(){throw Error("Unable to connect. Please try again later.")}})).status.subscribe(function(e){H(e)}),g=(0,S.ucN)({sessionType:S.dF3.AGENT_SESSION,replId:o}),[4,d.service.createSession.rpc(g)];case 1:if(!(p=y.sent()).ok)throw Error("Failed to send agent prompt. Session creation failed.");return h=p.payload.sessionId,m=p.payload.sessionCreationEventId,f=(0,S.kT_)({session:h,parent:m,model:S.e3q.ADVANCED,sender:{id:u,membership:S.VMq.CORE,timeCreated:new Date(q)},addToChild:!1,data:{kind:"message",message:n,uploadedFiles:t,attachedUrls:a,requestedStackBlueprint:i,intent:S.qRv.AGENT}}),d.service.createEvent.rpc(f.request),(0,I.u4)(Y.AZ.START_WITH_AI_USED,{action:"created_agent_session",prompt:n,attachments:t,attached_urls:a,repl_id:o,username:v,email:_,is_mobile:M,has_agent:!0,send_to_slack_bot:z,session_id:h,langsmith_url:(0,E.Yd)(h,S.dF3.AGENT_SESSION)}),(0,D.pI)({action:"created_new_session",sessionId:h}),[2]}})}),function(e){return j.apply(this,arguments)}),em=(G=(0,o._)((K={onError:function(e){w.Cp(e)}},$=(0,a._)({},U,K),g.n(B,$)),1)[0],function(e){var n=e.prompt,t=e.attachments,r=e.replId;G({variables:{prompt:n+(t.length>0?"\n\nWith attachments: ".concat(t.map(function(e){return e.path}).join(", ")):""),replId:r}})});function ef(){return(ef=(0,r._)(function(e){var n,t,r,o,u,l,c,d,g,p,h,m,f,v,y;return(0,s.YH)(this,function(s){switch(s.label){case 0:if(n=e.prompt,t=e.attachments,r=e.attachedUrls,o=e.requestedStackBlueprint,u=e.isPrivate,l=e.teamId,c=e.orgId,eu)return et("This feature is currently unavailable."),X("idle"),[2];return(0,P.O7)(),[4,(0,F.u9)()];case 1:return s.sent(),X("creating_repl"),[4,er({variables:{input:{isUsingLobbySystem:!1,aiPromptText:n,aiPromptAttachmentPaths:t.map(function(e){return e.path}),folderId:ee,isPrivate:u,teamId:l,orgId:c}}})];case 2:if((d=s.sent()).errors)return ec(Error(d.errors.map(function(e){return e.message}).join(", "))),[2];if(!d.data)return ec(Error("Expected data from createRepl graphql mutation")),[2];if("message"in d.data.createRepl)return ec(Error(d.data.createRepl.message)),[2];if(g=d.data.createRepl,em({prompt:n,attachments:t,replId:g.id}),!(p=t&&t.length>0))return[3,4];return h=(0,L.O)({repl:g,currentUser:ea}),(m=(0,O.Ay)({onUnrecoverableError:function(e){X("idle"),et(e.message)}})).connect({context:h,getMinimumRetryDelayMs:ei}),X("configuring_repl"),[4,function(e){return J.apply(this,arguments)}({hasAttachments:p,attachments:t,container:m,handleError:ec})];case 3:s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,eh({prompt:n,uploadedFiles:t.map(function(e){return{path:e.path,mimeType:e.file.type}}),attachedUrls:r,requestedStackBlueprint:o,replId:g.id,currentUserId:V.id,orgId:c})];case 5:return s.sent(),[3,7];case 6:return ec((f=s.sent())instanceof Error?f:Error(String(f))),[2];case 7:if(X("opening_repl"),v={enterInAgentMode:!0,agentOnboarding:(null==ea?void 0:ea.replCount.__typename)==="ReplCount"&&(null==ea?void 0:ea.replCount.count)===0&&el},y=(0,W.q1)(g,v),!en)return[3,8];return window.location.href=(0,W.cY)(g,v),[3,10];case 8:return[4,eo.push((0,i._)((0,a._)({},y.href),{pathname:es}),y.as)];case 9:s.sent(),s.label=10;case 10:return X("idle"),[2]}})})).apply(this,arguments)}return{createAgentRepl:function(e){return ef.apply(this,arguments)},status:Q,agentPromptRiverConnectionStatus:eg}}function J(){return(J=(0,r._)(function(e){var n,t,r,a,i;return(0,s.YH)(this,function(o){switch(o.label){case 0:if(n=e.hasAttachments,t=e.container,r=e.attachments,a=e.handleError,!n)return[2];return i=(0,q.A)({container:t}),[4,(0,H.Zn)({parentPath:z.Ls,files:r.map(function(e){return e.file}),fs:i,onError:function(e){a(Error("Error uploading ".concat(e.path,": ").concat(e.error)))}})];case 1:return o.sent(),[2]}})})).apply(this,arguments)}}}]);
//# sourceMappingURL=3672-43404554dc63463e.js.map