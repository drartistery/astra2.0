!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="7516dbe8-237e-4608-9617-f08038631c60",e._sentryDebugIdIdentifier="sentry-dbid-7516dbe8-237e-4608-9617-f08038631c60")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"d5236f02"},(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3272,4070,8999],{1708:(e,t,r)=>{var n=r(41381),i=r(79907),s=r(43800),o=r(11459),a=r(94995),l=r(867),c=r(38688),u=r(52783),h="[object Arguments]",d="[object Array]",f="[object Object]",g=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,m,p,w){var v=l(e),b=l(t),y=v?d:a(e),k=b?d:a(t);y=y==h?f:y,k=k==h?f:k;var O=y==f,S=k==f,I=y==k;if(I&&c(e)){if(!c(t))return!1;v=!0,O=!1}if(I&&!O)return w||(w=new n),v||u(e)?i(e,t,r,m,p,w):s(e,t,y,r,m,p,w);if(!(1&r)){var P=O&&g.call(e,"__wrapped__"),D=S&&g.call(t,"__wrapped__");if(P||D){var A=P?e.value():e,x=D?t.value():t;return w||(w=new n),p(A,x,r,m,w)}}return!!I&&(w||(w=new n),o(e,t,r,m,p,w))}},4880:(e,t,r)=>{"use strict";r.d(t,{Te:()=>a});var n=r(21462),i=r(47993),s=r(93707);let o="undefined"!=typeof document?n.useLayoutEffect:n.useEffect;function a(e){return function(e){let t=n.useReducer(()=>({}),{})[1],r={...e,onChange:(r,n)=>{var s;n?(0,i.flushSync)(t):t(),null==(s=e.onChange)||s.call(e,r,n)}},[a]=n.useState(()=>new s.YV(r));return a.setOptions(r),o(()=>a._didMount(),[]),o(()=>a._willUpdate()),a}({observeElementRect:s.T6,observeElementOffset:s.AO,scrollToFn:s.Ox,...e})}},11374:(e,t,r)=>{"use strict";r.d(t,{V:()=>a});var n=r(12694),i=r(21462),s=r(83850),o=r(62795);function a(e){var t=(0,o.u)().getMonitor(),r=(0,n._)((0,s.F)(t,e),2),a=r[0],l=r[1];return(0,i.useEffect)(function(){return t.subscribeToOffsetChange(l)}),(0,i.useEffect)(function(){return t.subscribeToStateChange(l)}),a}},11459:(e,t,r)=>{var n=r(54596),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,s,o,a){var l=1&r,c=n(e),u=c.length;if(u!=n(t).length&&!l)return!1;for(var h=u;h--;){var d=c[h];if(!(l?d in t:i.call(t,d)))return!1}var f=a.get(e),g=a.get(t);if(f&&g)return f==t&&g==e;var m=!0;a.set(e,t),a.set(t,e);for(var p=l;++h<u;){var w=e[d=c[h]],v=t[d];if(s)var b=l?s(v,w,d,t,e,a):s(w,v,d,e,t,a);if(!(void 0===b?w===v||o(w,v,r,s,a):b)){m=!1;break}p||(p="constructor"==d)}if(m&&!p){var y=e.constructor,k=t.constructor;y!=k&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof k&&k instanceof k)&&(m=!1)}return a.delete(e),a.delete(t),m}},14408:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},16182:(e,t,r)=>{var n=r(22313);e.exports=function(e,t){return n(e,t)}},17230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(86519);function i(e,t){return{get:e,getLength:()=>e().length,insert:(r,i,s)=>t([n.strPosToUni(e(),r),i],s),remove:(r,i,s)=>t([n.strPosToUni(e(),r),{d:i}],s),_onOp(e){for(var t=0,r=0,n=0;n<e.length;n++){var i=e[n];switch(typeof i){case"number":t+=i,r+=i;break;case"string":this.onInsert&&this.onInsert(t,i),t+=i.length;break;case"object":this.onRemove&&this.onRemove(t,i.d),r+=i.d}}},onInsert:null,onRemove:null}}t.default=i,i.provides={text:!0}},22313:(e,t,r)=>{var n=r(1708),i=r(50482);e.exports=function e(t,r,s,o,a){return t===r||(null!=t&&null!=r&&(i(t)||i(r))?n(t,r,s,o,e,a):t!=t&&r!=r)}},27255:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(86519),i=e=>{if(!Array.isArray(e))throw Error("Op must be an array of components");let t=null;for(let r=0;r<e.length;r++){let n=e[r];switch(typeof n){case"object":if(!("number"==typeof n.d&&n.d>0))throw Error("Object components must be deletes of size > 0");break;case"string":if(!(n.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(n>0))throw Error("Skip components must be >0");if("number"==typeof t)throw Error("Adjacent skip components should be combined")}t=n}if("number"==typeof t)throw Error("Op has a trailing skip")},s=e=>{let t=[],r=o(t);for(let t=0;t<e.length;t++)r(e[t]);return c(t)},o=e=>t=>{t&&0!==t.d&&(0===e.length?e.push(t):typeof t==typeof e[e.length-1]?"object"==typeof t?e[e.length-1].d+=t.d:e[e.length-1]+=t:e.push(t))},a=e=>"number"==typeof e?e:"string"==typeof e?n.strPosToUni(e):e.d,l=e=>{let t=0,r=0;return{take:(i,s)=>{let o;if(t===e.length)return -1===i?null:i;let a=e[t];if("number"==typeof a)if(-1===i||a-r<=i)return o=a-r,++t,r=0,o;else return r+=i,i;if("string"==typeof a)if(-1===i||"i"===s||n.strPosToUni(a.slice(r))<=i)return o=a.slice(r),++t,r=0,o;else{let e=r+n.uniToStrPos(a.slice(r),i);return o=a.slice(r,e),r=e,o}return -1===i||"d"===s||a.d-r<=i?(o={d:a.d-r},++t,r=0,o):(r+=i,{d:i})},peek:()=>e[t]}},c=e=>(e.length>0&&"number"==typeof e[e.length-1]&&e.pop(),e);function u(e,t,r){let s;if("left"!==r&&"right"!==r)throw Error("side ("+r+") must be 'left' or 'right'");i(e),i(t);let u=[],h=o(u),{take:d,peek:f}=l(e);for(let e=0;e<t.length;e++){let i,s,o=t[e];switch(typeof o){case"number":for(i=o;i>0;)h(s=d(i,"i")),"string"!=typeof s&&(i-=a(s));break;case"string":"left"===r&&"string"==typeof f()&&h(d(-1)),h(n.strPosToUni(o));break;case"object":for(i=o.d;i>0;)switch(typeof(s=d(i,"i"))){case"number":i-=s;break;case"string":h(s);break;case"object":i-=s.d}}}for(;s=d(-1);)h(s);return c(u)}function h(e,t){let r;i(e),i(t);let s=[],u=o(s),{take:h}=l(e);for(let e=0;e<t.length;e++){let r,i,s=t[e];switch(typeof s){case"number":for(r=s;r>0;)u(i=h(r,"d")),"object"!=typeof i&&(r-=a(i));break;case"string":u(s);break;case"object":for(r=s.d;r>0;)switch(typeof(i=h(r,"d"))){case"number":u({d:i}),r-=i;break;case"string":r-=n.strPosToUni(i);break;case"object":u(i)}}}for(;r=h(-1);)u(r);return c(s)}let d=(e,t)=>{let r=0;for(let i=0;i<t.length&&e>r;i++){let s=t[i];switch(typeof s){case"number":r+=s;break;case"string":let o=n.strPosToUni(s);r+=o,e+=o;break;case"object":e-=Math.min(s.d,e-r)}}return e},f=(e,t)=>"number"==typeof e?d(e,t):e.map(e=>d(e,t));t.default=function(e){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:c,normalize:s,checkOp:i,create(t=""){if("string"!=typeof t)throw Error("Initial data must be a string");return e.create(t)},apply(t,r){i(r);let n=e.builder(t);for(let e=0;e<r.length;e++){let t=r[e];switch(typeof t){case"number":n.skip(t);break;case"string":n.append(t);break;case"object":n.del(t.d)}}return n.build()},transform:u,compose:h,transformPosition:d,transformSelection:f}}},27757:(e,t,r)=>{var n=r(84503),i=r(14408),s=r(68923);function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=s,e.exports=o},29065:e=>{e.exports=function(e,t){return e.has(t)}},35141:e=>{var t=1/0,r=0/0,n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt,l=Object.prototype.toString,c=Math.max,u=Math.min;function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function d(e){return e?(e=f(e))===t||e===-t?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}function f(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==l.call(t))return r;if(h(e)){var t,c="function"==typeof e.valueOf?e.valueOf():e;e=h(c)?c+"":c}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var u=s.test(e);return u||o.test(e)?a(e.slice(2),u?2:8):i.test(e)?r:+e}e.exports=function(e,t,r){var n,i,s;return t=d(t),void 0===r?(r=t,t=0):r=d(r),(n=e=f(e))>=u(i=t,s=r)&&n<c(i,s)}},43800:(e,t,r)=>{var n=r(82087),i=r(73582),s=r(55304),o=r(79907),a=r(85443),l=r(61389),c=n?n.prototype:void 0,u=c?c.valueOf:void 0;e.exports=function(e,t,r,n,c,h,d){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!h(new i(e),new i(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return s(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var g=1&n;if(f||(f=l),e.size!=t.size&&!g)break;var m=d.get(e);if(m)return m==t;n|=2,d.set(e,t);var p=o(f(e),f(t),n,c,h,d);return d.delete(e),p;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},44070:(e,t,r)=>{"use strict";r.d(t,{i:()=>O});var n=r(31955),i=r(22255),s=r(91771),o=r(21462),a=r(37743),l=r(48122),c=r(54829),u=r(85543),h=r(44699),d=function(){function e(t){var r=this;(0,a._)(this,e),this.hooks=(0,h.i)({dragSource:function(e,t){r.clearDragSource(),r.dragSourceOptions=t||null,(0,u.i)(e)?r.dragSourceRef=e:r.dragSourceNode=e,r.reconnectDragSource()},dragPreview:function(e,t){r.clearDragPreview(),r.dragPreviewOptions=t||null,(0,u.i)(e)?r.dragPreviewRef=e:r.dragPreviewNode=e,r.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=t}return(0,l._)(e,[{key:"receiveHandlerId",value:function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}},{key:"connectTarget",get:function(){return this.dragSource}},{key:"dragSourceOptions",get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e}},{key:"dragPreviewOptions",get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e}},{key:"reconnect",value:function(){var e=this.reconnectDragSource();this.reconnectDragPreview(e)}},{key:"reconnectDragSource",value:function(){var e=this.dragSource,t=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return t&&this.disconnectDragSource(),this.handlerId&&(e?t&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)):this.lastConnectedDragSource=e),t}},{key:"reconnectDragPreview",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),this.handlerId){if(!t){this.lastConnectedDragPreview=t;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))}}},{key:"didHandlerIdChange",value:function(){return this.lastConnectedHandlerId!==this.handlerId}},{key:"didConnectedDragSourceChange",value:function(){return this.lastConnectedDragSource!==this.dragSource}},{key:"didConnectedDragPreviewChange",value:function(){return this.lastConnectedDragPreview!==this.dragPreview}},{key:"didDragSourceOptionsChange",value:function(){return!(0,c.b)(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}},{key:"didDragPreviewOptionsChange",value:function(){return!(0,c.b)(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}},{key:"disconnectDragSource",value:function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}},{key:"disconnectDragPreview",value:function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}},{key:"dragSource",get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}},{key:"dragPreview",get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}},{key:"clearDragSource",value:function(){this.dragSourceNode=null,this.dragSourceRef=null}},{key:"clearDragPreview",value:function(){this.dragPreviewNode=null,this.dragPreviewRef=null}}]),e}(),f=r(62795),g=r(80285),m=!1,p=!1,w=function(){function e(t){(0,a._)(this,e),this.sourceId=null,this.internalMonitor=t.getMonitor()}return(0,l._)(e,[{key:"receiveHandlerId",value:function(e){this.sourceId=e}},{key:"getHandlerId",value:function(){return this.sourceId}},{key:"canDrag",value:function(){(0,n.V)(!m,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return m=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{m=!1}}},{key:"isDragging",value:function(){if(!this.sourceId)return!1;(0,n.V)(!p,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return p=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{p=!1}}},{key:"subscribeToStateChange",value:function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)}},{key:"isDraggingSource",value:function(e){return this.internalMonitor.isDraggingSource(e)}},{key:"isOverTarget",value:function(e,t){return this.internalMonitor.isOverTarget(e,t)}},{key:"getTargetIds",value:function(){return this.internalMonitor.getTargetIds()}},{key:"isSourcePublic",value:function(){return this.internalMonitor.isSourcePublic()}},{key:"getSourceId",value:function(){return this.internalMonitor.getSourceId()}},{key:"subscribeToOffsetChange",value:function(e){return this.internalMonitor.subscribeToOffsetChange(e)}},{key:"canDragSource",value:function(e){return this.internalMonitor.canDragSource(e)}},{key:"canDropOnTarget",value:function(e){return this.internalMonitor.canDropOnTarget(e)}},{key:"getItemType",value:function(){return this.internalMonitor.getItemType()}},{key:"getItem",value:function(){return this.internalMonitor.getItem()}},{key:"getDropResult",value:function(){return this.internalMonitor.getDropResult()}},{key:"didDrop",value:function(){return this.internalMonitor.didDrop()}},{key:"getInitialClientOffset",value:function(){return this.internalMonitor.getInitialClientOffset()}},{key:"getInitialSourceClientOffset",value:function(){return this.internalMonitor.getInitialSourceClientOffset()}},{key:"getSourceClientOffset",value:function(){return this.internalMonitor.getSourceClientOffset()}},{key:"getClientOffset",value:function(){return this.internalMonitor.getClientOffset()}},{key:"getDifferenceFromInitialOffset",value:function(){return this.internalMonitor.getDifferenceFromInitialOffset()}}]),e}(),v=r(12694),b=r(64363),y=r(22531),k=function(){function e(t,r,n){(0,a._)(this,e),this.spec=t,this.monitor=r,this.connector=n}return(0,l._)(e,[{key:"beginDrag",value:function(){var e=this.spec,t=this.monitor,r=null;return null!=(r="object"===(0,y._)(e.item)?e.item:"function"==typeof e.item?e.item(t):{})?r:null}},{key:"canDrag",value:function(){var e=this.spec,t=this.monitor;return"boolean"==typeof e.canDrag?e.canDrag:"function"!=typeof e.canDrag||e.canDrag(t)}},{key:"isDragging",value:function(e,t){var r=this.spec,n=this.monitor,i=r.isDragging;return i?i(n):t===e.getSourceId()}},{key:"endDrag",value:function(){var e=this.spec,t=this.monitor,r=this.connector,n=e.end;n&&n(t.getItem(),t),r.reconnect()}}]),e}();function O(e,t){var r,a,l,c,u,h,m,p,y,O=(0,s.I)(e,t);(0,n.V)(!O.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");var S=(r=(0,f.u)(),(0,o.useMemo)(function(){return new w(r)},[r])),I=(a=O.options,l=O.previewOptions,c=(0,f.u)(),u=(0,o.useMemo)(function(){return new d(c.getBackend())},[c]),(0,g.E)(function(){return u.dragSourceOptions=a||null,u.reconnect(),function(){return u.disconnectDragSource()}},[u,a]),(0,g.E)(function(){return u.dragPreviewOptions=l||null,u.reconnect(),function(){return u.disconnectDragPreview()}},[u,l]),u);return h=(0,f.u)(),m=(0,o.useMemo)(function(){return new k(O,S,I)},[S,I]),(0,o.useEffect)(function(){m.spec=O},[O]),p=m,y=(0,o.useMemo)(function(){var e=O.type;return(0,n.V)(null!=e,"spec.type must be defined"),e},[O]),(0,g.E)(function(){if(null!=y){var e=(0,v._)((0,b.V)(y,p,h),2),t=e[0],r=e[1];return S.receiveHandlerId(t),I.receiveHandlerId(t),r}},[h,S,I,p,y]),[(0,i.j)(O.collect,S,I),(0,o.useMemo)(function(){return I.hooks.dragSource()},[I]),(0,o.useMemo)(function(){return I.hooks.dragPreview()},[I])]}},50679:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(65041),i=r(99570),s=r(57010);function o(e,t){(0,s.A)(2,arguments);var r=(0,n.A)(t);return(0,i.A)(e,1e3*r)}},52535:(e,t)=>{!function(e){"undefined"==typeof DO_NOT_EXPORT_CRC?e(t):e({})}(function(e){e.version="1.2.2";var t=function(){for(var e=0,t=Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1)?-0x12477ce0^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),r=function(e){var t=0,r=0,n=0,i="undefined"!=typeof Int32Array?new Int32Array(4096):Array(4096);for(n=0;256!=n;++n)i[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!=typeof Int32Array?i.subarray(256*n,256*n+256):i.slice(256*n,256*n+256);return s}(t),n=r[0],i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],f=r[10],g=r[11],m=r[12],p=r[13],w=r[14];e.table=t,e.bstr=function(e,r){for(var n=-1^r,i=0,s=e.length;i<s;)n=n>>>8^t[(n^e.charCodeAt(i++))&255];return~n},e.buf=function(e,r){for(var v=-1^r,b=e.length-15,y=0;y<b;)v=w[e[y++]^255&v]^p[e[y++]^v>>8&255]^m[e[y++]^v>>16&255]^g[e[y++]^v>>>24]^f[e[y++]]^d[e[y++]]^h[e[y++]]^u[e[y++]]^c[e[y++]]^l[e[y++]]^a[e[y++]]^o[e[y++]]^s[e[y++]]^i[e[y++]]^n[e[y++]]^t[e[y++]];for(b+=15;y<b;)v=v>>>8^t[(v^e[y++])&255];return~v},e.str=function(e,r){for(var n=-1^r,i=0,s=e.length,o=0,a=0;i<s;)(o=e.charCodeAt(i++))<128?n=n>>>8^t[(n^o)&255]:o<2048?n=(n=n>>>8^t[(n^(192|o>>6&31))&255])>>>8^t[(n^(128|63&o))&255]:o>=55296&&o<57344?(o=(1023&o)+64,a=1023&e.charCodeAt(i++),n=(n=(n=(n=n>>>8^t[(n^(240|o>>8&7))&255])>>>8^t[(n^(128|o>>2&63))&255])>>>8^t[(n^(128|a>>6&15|(3&o)<<4))&255])>>>8^t[(n^(128|63&a))&255]):n=(n=(n=n>>>8^t[(n^(224|o>>12&15))&255])>>>8^t[(n^(128|o>>6&63))&255])>>>8^t[(n^(128|63&o))&255];return~n}})},56902:(e,t,r)=>{"use strict";r.d(t,{_:()=>a});var n=r(76599),i=r(74379),s=r(41186),o=r(81775);function a(e){return(0,n._)(e)||(0,i._)(e)||(0,o._)(e)||(0,s._)()}},61389:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},66474:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.type=void 0;let i=r(86519),s=n(r(27255)),o=n(r(17230));t.type=Object.assign(Object.assign({},s.default({create:e=>e,toString:e=>e,builder(e){if("string"!=typeof e)throw Error("Invalid document snapshot: "+e);let t=[];return{skip(r){let n=i.uniToStrPos(e,r);if(n>e.length)throw Error("The op is too long for this document");t.push(e.slice(0,n)),e=e.slice(n)},append(e){t.push(e)},del(t){e=e.slice(i.uniToStrPos(e,t))},build:()=>t.join("")+e}}})),{api:o.default});var a=r(27255);Object.defineProperty(t,"makeType",{enumerable:!0,get:function(){return a.default}})},68923:e=>{e.exports=function(e){return this.__data__.has(e)}},71788:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},72562:(e,t,r)=>{"use strict";let n;function i(){return n||((n=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),n}r.d(t,{n:()=>i})},79907:(e,t,r)=>{var n=r(27757),i=r(71788),s=r(29065);e.exports=function(e,t,r,o,a,l){var c=1&r,u=e.length,h=t.length;if(u!=h&&!(c&&h>u))return!1;var d=l.get(e),f=l.get(t);if(d&&f)return d==t&&f==e;var g=-1,m=!0,p=2&r?new n:void 0;for(l.set(e,t),l.set(t,e);++g<u;){var w=e[g],v=t[g];if(o)var b=c?o(v,w,g,t,e,l):o(w,v,g,e,t,l);if(void 0!==b){if(b)continue;m=!1;break}if(p){if(!i(t,function(e,t){if(!s(p,t)&&(w===e||a(w,e,r,o,l)))return p.push(t)})){m=!1;break}}else if(!(w===v||a(w,v,r,o,l))){m=!1;break}}return l.delete(e),l.delete(t),m}},85443:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},86519:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniToStrPos=t.strPosToUni=void 0,t.strPosToUni=(e,t=e.length)=>{let r=0,n=0;for(;n<t;n++){let t=e.charCodeAt(n);t>=55296&&t<=57343&&(r++,n++)}if(n!==t)throw Error("Invalid offset - splits unicode bytes");return n-r},t.uniToStrPos=(e,t)=>{let r=0;for(;t>0;t--){let t=e.charCodeAt(r);r+=t>=55296&&t<=57343?2:1}return r}},93707:(e,t,r)=>{"use strict";r.d(t,{YV:()=>w,vp:()=>u,Ox:()=>p,AO:()=>g,T6:()=>h});var n=r(95570);function i(e,t,r){let i,s=r.initialDeps??[];return()=>{var o,a,l,c;let u,h;r.key&&(null==(o=r.debug)?void 0:o.call(r))&&(u=Date.now());let d=e();if(!(d.length!==s.length||d.some((e,t)=>s[t]!==e)))return i;if(s=d,r.key&&(null==(a=r.debug)?void 0:a.call(r))&&(h=Date.now()),i=t(...d),r.key&&(null==(l=r.debug)?void 0:l.call(r))){let e=Math.round((Date.now()-u)*100)/100,t=Math.round((Date.now()-h)*100)/100,i=t/16,s=(e,t)=>{for(e=String(e);e.length<t;)e=" "+e;return e};n.info(`%c⏱ ${s(t,5)} /${s(e,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*i,120))}deg 100% 31%);`,null==r?void 0:r.key)}return null==(c=null==r?void 0:r.onChange)||c.call(r,i),i}}function s(e,t){if(void 0!==e)return e;throw Error(`Unexpected undefined${t?`: ${t}`:""}`)}let o=(e,t)=>1>Math.abs(e-t),a=(e,t,r)=>{let n;return function(...i){e.clearTimeout(n),n=e.setTimeout(()=>t.apply(this,i),r)}};var l=r(95570);let c=e=>e,u=e=>{let t=Math.max(e.startIndex-e.overscan,0),r=Math.min(e.endIndex+e.overscan,e.count-1),n=[];for(let e=t;e<=r;e++)n.push(e);return n},h=(e,t)=>{let r=e.scrollElement;if(!r)return;let n=e.targetWindow;if(!n)return;let i=e=>{let{width:r,height:n}=e;t({width:Math.round(r),height:Math.round(n)})};if(i(r.getBoundingClientRect()),!n.ResizeObserver)return()=>{};let s=new n.ResizeObserver(e=>{let t=e[0];if(null==t?void 0:t.borderBoxSize){let e=t.borderBoxSize[0];if(e)return void i({width:e.inlineSize,height:e.blockSize})}i(r.getBoundingClientRect())});return s.observe(r,{box:"border-box"}),()=>{s.unobserve(r)}},d={passive:!0},f="undefined"==typeof window||"onscrollend"in window,g=(e,t)=>{let r=e.scrollElement;if(!r)return;let n=e.targetWindow;if(!n)return;let i=0,s=e.options.useScrollendEvent&&f?()=>void 0:a(n,()=>{t(i,!1)},e.options.isScrollingResetDelay),o=n=>()=>{let{horizontal:o,isRtl:a}=e.options;i=o?r.scrollLeft*(a&&-1||1):r.scrollTop,s(),t(i,n)},l=o(!0),c=o(!1);return c(),r.addEventListener("scroll",l,d),r.addEventListener("scrollend",c,d),()=>{r.removeEventListener("scroll",l),r.removeEventListener("scrollend",c)}},m=(e,t,r)=>{if(null==t?void 0:t.borderBoxSize){let e=t.borderBoxSize[0];if(e)return Math.round(e[r.options.horizontal?"inlineSize":"blockSize"])}return Math.round(e.getBoundingClientRect()[r.options.horizontal?"width":"height"])},p=(e,{adjustments:t=0,behavior:r},n)=>{var i,s;null==(s=null==(i=n.scrollElement)?void 0:i.scrollTo)||s.call(i,{[n.options.horizontal?"left":"top"]:e+t,behavior:r})};class w{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null,t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver(e=>{e.forEach(e=>{this._measureElement(e.target,e)})}):null);return{disconnect:()=>{var r;null==(r=t())||r.disconnect(),e=null},observe:e=>{var r;return null==(r=t())?void 0:r.observe(e,{box:"border-box"})},unobserve:e=>{var r;return null==(r=t())?void 0:r.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,r])=>{void 0===r&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:c,rangeExtractor:u,onChange:()=>{},measureElement:m,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!0,...e}},this.notify=e=>{var t,r;null==(r=(t=this.options).onChange)||r.call(t,this,e)},this.maybeNotify=i(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;let t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.maybeNotify();this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=t,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{let r=new Map,n=new Map;for(let i=t-1;i>=0;i--){let t=e[i];if(r.has(t.lane))continue;let s=n.get(t.lane);if(null==s||t.end>s.end?n.set(t.lane,t):t.end<s.end&&r.set(t.lane,!0),r.size===this.options.lanes)break}return n.size===this.options.lanes?Array.from(n.values()).sort((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end)[0]:void 0},this.getMeasurementOptions=i(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,t,r,n,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:r,getItemKey:n,enabled:i}),{key:!1}),this.getMeasurements=i(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:r,getItemKey:n,enabled:i},s)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),[];0===this.measurementsCache.length&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}));let o=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];let a=this.measurementsCache.slice(0,o);for(let i=o;i<e;i++){let e=n(i),o=1===this.options.lanes?a[i-1]:this.getFurthestMeasurement(a,i),l=o?o.end+this.options.gap:t+r,c=s.get(e),u="number"==typeof c?c:this.options.estimateSize(i),h=l+u,d=o?o.lane:i%this.options.lanes;a[i]={index:i,start:l,size:u,end:h,key:e,lane:d}}return this.measurementsCache=a,a},{key:!1,debug:()=>this.options.debug}),this.calculateRange=i(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(e,t,r)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:r}){let n=e.length-1,i=v(0,n,t=>e[t].start,r),s=i;for(;s<n&&e[s].end<r+t;)s++;return{startIndex:i,endIndex:s}}({measurements:e,outerSize:t,scrollOffset:r}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=i(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,t,r,n)=>null===t?[]:e({startIndex:t.startIndex,endIndex:t.endIndex,overscan:r,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{let t=this.options.indexAttribute,r=e.getAttribute(t);return r?parseInt(r,10):(l.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{let r=this.indexFromElement(e),n=this.measurementsCache[r];if(!n)return;let i=n.key,s=this.elementsCache.get(i);s!==e&&(s&&this.observer.unobserve(s),this.observer.observe(e),this.elementsCache.set(i,e)),e.isConnected&&this.resizeItem(r,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{let r=this.measurementsCache[e];if(!r)return;let n=t-(this.itemSizeCache.get(r.key)??r.size);0!==n&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(r,n,this):r.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=n,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(r.index),this.itemSizeCache=new Map(this.itemSizeCache.set(r.key,t)),this.notify(!1))},this.measureElement=e=>{if(!e)return void this.elementsCache.forEach((e,t)=>{e.isConnected||(this.observer.unobserve(e),this.elementsCache.delete(t))});this._measureElement(e,void 0)},this.getVirtualItems=i(()=>[this.getIndexes(),this.getMeasurements()],(e,t)=>{let r=[];for(let n=0,i=e.length;n<i;n++){let i=t[e[n]];r.push(i)}return r},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{let t=this.getMeasurements();if(0!==t.length)return s(t[v(0,t.length-1,e=>s(t[e]).start,e)])},this.getOffsetForAlignment=(e,t)=>{let r=this.getSize(),n=this.getScrollOffset();"auto"===t&&e>=n+r&&(t="end"),"end"===t&&(e-=r);let i=this.options.horizontal?"scrollWidth":"scrollHeight";return Math.max(Math.min((this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-r,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));let r=this.measurementsCache[e];if(!r)return;let n=this.getSize(),i=this.getScrollOffset();if("auto"===t)if(r.end>=i+n-this.options.scrollPaddingEnd)t="end";else{if(!(r.start<=i+this.options.scrollPaddingStart))return[i,t];t="start"}let s=r.start-this.options.scrollPaddingStart+(r.size-n)/2;switch(t){case"center":return[this.getOffsetForAlignment(s,t),t];case"end":return[this.getOffsetForAlignment(r.end+this.options.scrollPaddingEnd,t),t];default:return[this.getOffsetForAlignment(r.start-this.options.scrollPaddingStart,t),t]}},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{null!==this.scrollToIndexTimeoutId&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t="start",behavior:r}={})=>{this.cancelScrollToIndex(),"smooth"===r&&this.isDynamicMode()&&l.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:r})},this.scrollToIndex=(e,{align:t="auto",behavior:r}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),"smooth"===r&&this.isDynamicMode()&&l.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");let n=this.getOffsetForIndex(e,t);if(!n)return;let[i,a]=n;this._scrollToOffset(i,{adjustments:void 0,behavior:r}),"smooth"!==r&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){let[t]=s(this.getOffsetForIndex(e,a));o(t,this.getScrollOffset())||this.scrollToIndex(e,{align:a,behavior:r})}else this.scrollToIndex(e,{align:a,behavior:r})}))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),"smooth"===t&&this.isDynamicMode()&&l.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;let t,r=this.getMeasurements();return Math.max((0===r.length?this.options.paddingStart:1===this.options.lanes?(null==(e=r[r.length-1])?void 0:e.end)??0:Math.max(...r.slice(-this.options.lanes).map(e=>e.end)))-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:r})=>{this.options.scrollToFn(e,{behavior:r,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}let v=(e,t,r,n)=>{for(;e<=t;){let i=(e+t)/2|0,s=r(i);if(s<n)e=i+1;else{if(!(s>n))return i;t=i-1}}return e>0?e-1:0}},96820:(e,t,r)=>{"use strict";r.d(t,{qg:()=>y});class n extends Error{line;column;codeblock;constructor(e,t){let[r,n]=function(e,t){let r=e.slice(0,t).split(/\r\n|\n|\r/g);return[r.length,r.pop().length+1]}(t.toml,t.ptr),i=function(e,t,r){let n=e.split(/\r\n|\n|\r/g),i="",s=(0|Math.log10(t+1))+1;for(let e=t-1;e<=t+1;e++){let o=n[e-1];o&&(i+=e.toString().padEnd(s," "),i+=":  ",i+=o,i+="\n",e===t&&(i+=" ".repeat(s+r+2),i+="^\n"))}return i}(t.toml,r,n);super(`Invalid TOML document: ${e}

${i}`,t),this.line=r,this.column=n,this.codeblock=i}}function i(e,t=0,r=e.length){let n=e.indexOf("\n",t);return"\r"===e[n-1]&&n--,n<=r?n:-1}function s(e,t){for(let r=t;r<e.length;r++){let i=e[r];if("\n"===i)return r;if("\r"===i&&"\n"===e[r+1])return r+1;if(i<" "&&"	"!==i||""===i)throw new n("control characters are not allowed in comments",{toml:e,ptr:t})}return e.length}function o(e,t,r,n){let i;for(;" "===(i=e[t])||"	"===i||!r&&("\n"===i||"\r"===i&&"\n"===e[t+1]);)t++;return n||"#"!==i?t:o(e,s(e,t),r)}function a(e,t,r,s,o=!1){if(!s)return(t=i(e,t))<0?e.length:t;for(let n=t;n<e.length;n++){let t=e[n];if("#"===t)n=i(e,n);else if(t===r)return n+1;else if(t===s)return n;else if(o&&("\n"===t||"\r"===t&&"\n"===e[n+1]))return n}throw new n("cannot find end of structure",{toml:e,ptr:t})}function l(e,t){let r=e[t],n=r===e[t+1]&&e[t+1]===e[t+2]?e.slice(t,t+3):r;t+=n.length-1;do t=e.indexOf(n,++t);while(t>-1&&"'"!==r&&"\\"===e[t-1]&&"\\"!==e[t-2]);return t>-1&&(t+=n.length,n.length>1&&(e[t]===r&&t++,e[t]===r&&t++)),t}let c=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i;class u extends Date{#e=!1;#t=!1;#r=null;constructor(e){let t=!0,r=!0,n="Z";if("string"==typeof e){let i=e.match(c);i?(i[1]||(t=!1,e=`0000-01-01T${e}`),r=!!i[2],i[2]&&+i[2]>23?e="":(n=i[3]||null,e=e.toUpperCase(),!n&&r&&(e+="Z"))):e=""}super(e),isNaN(this.getTime())||(this.#e=t,this.#t=r,this.#r=n)}isDateTime(){return this.#e&&this.#t}isLocal(){return!this.#e||!this.#t||!this.#r}isDate(){return this.#e&&!this.#t}isTime(){return this.#t&&!this.#e}isValid(){return this.#e||this.#t}toISOString(){let e=super.toISOString();if(this.isDate())return e.slice(0,10);if(this.isTime())return e.slice(11,23);if(null===this.#r)return e.slice(0,-1);if("Z"===this.#r)return e;let t=60*this.#r.slice(1,3)+ +this.#r.slice(4,6);return t="-"===this.#r[0]?t:-t,new Date(this.getTime()-6e4*t).toISOString().slice(0,-1)+this.#r}static wrapAsOffsetDateTime(e,t="Z"){let r=new u(e);return r.#r=t,r}static wrapAsLocalDateTime(e){let t=new u(e);return t.#r=null,t}static wrapAsLocalDate(e){let t=new u(e);return t.#t=!1,t.#r=null,t}static wrapAsLocalTime(e){let t=new u(e);return t.#e=!1,t.#r=null,t}}let h=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,d=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,f=/^[+-]?0[0-9_]/,g=/^[0-9a-f]{4,8}$/i,m={b:"\b",t:"	",n:"\n",f:"\f",r:"\r",'"':'"',"\\":"\\"};function p(e,t=0,r=e.length){let i,s="'"===e[t],a=e[t++]===e[t]&&e[t]===e[t+1];a&&(r-=2,"\r"===e[t+=2]&&t++,"\n"===e[t]&&t++);let l=0,c="",u=t;for(;t<r-1;){let r=e[t++];if("\n"===r||"\r"===r&&"\n"===e[t]){if(!a)throw new n("newlines are not allowed in strings",{toml:e,ptr:t-1})}else if(r<" "&&"	"!==r||""===r)throw new n("control characters are not allowed in strings",{toml:e,ptr:t-1});if(i){if(i=!1,"u"===r||"U"===r){let i=e.slice(t,t+="u"===r?4:8);if(!g.test(i))throw new n("invalid unicode escape",{toml:e,ptr:l});try{c+=String.fromCodePoint(parseInt(i,16))}catch{throw new n("invalid unicode escape",{toml:e,ptr:l})}}else if(a&&("\n"===r||" "===r||"	"===r||"\r"===r)){if(t=o(e,t-1,!0),"\n"!==e[t]&&"\r"!==e[t])throw new n("invalid escape: only line-ending whitespace may be escaped",{toml:e,ptr:l});t=o(e,t)}else if(r in m)c+=m[r];else throw new n("unrecognized escape sequence",{toml:e,ptr:l});u=t}else s||"\\"!==r||(l=t-1,i=!0,c+=e.slice(u,l))}return c+e.slice(u,r-1)}let w=/^[a-zA-Z0-9-_]+[ \t]*$/;function v(e,t,r="="){let s=t-1,a=[],c=e.indexOf(r,t);if(c<0)throw new n("incomplete key-value: cannot find end of key",{toml:e,ptr:t});do{let o=e[t=++s];if(" "!==o&&"	"!==o)if('"'===o||"'"===o){if(o===e[t+1]&&o===e[t+2])throw new n("multiline strings are not allowed in keys",{toml:e,ptr:t});let u=l(e,t);if(u<0)throw new n("unfinished string encountered",{toml:e,ptr:t});s=e.indexOf(".",u);let h=e.slice(u,s<0||s>c?c:s),d=i(h);if(d>-1)throw new n("newlines are not allowed in keys",{toml:e,ptr:t+s+d});if(h.trimStart())throw new n("found extra tokens after the string part",{toml:e,ptr:u});if(c<u&&(c=e.indexOf(r,u))<0)throw new n("incomplete key-value: cannot find end of key",{toml:e,ptr:t});a.push(p(e,t,u))}else{s=e.indexOf(".",t);let r=e.slice(t,s<0||s>c?c:s);if(!w.test(r))throw new n("only letter, numbers, dashes and underscores are allowed in keys",{toml:e,ptr:t});a.push(r.trimEnd())}}while(s+1&&s<c);return[a,o(e,c+1,!0,!0)]}function b(e,t,r,n){let i,s,o=t,a=r,l=!1;for(let t=0;t<e.length;t++){if(t){if(o=l?o[i]:o[i]={},a=(s=a[i]).c,0===n&&(1===s.t||2===s.t))return null;if(2===s.t){let e=o.length-1;o=o[e],a=a[e].c}}if((l=Object.hasOwn(o,i=e[t]))&&a[i]?.t===0&&a[i]?.d)return null;l||("__proto__"===i&&(Object.defineProperty(o,i,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(a,i,{enumerable:!0,configurable:!0,writable:!0})),a[i]={t:t<e.length-1&&2===n?3:n,d:!1,i:0,c:{}})}if((s=a[i]).t!==n&&(1!==n||3!==s.t)||(2===n&&(s.d||(s.d=!0,o[i]=[]),o[i].push(o={}),s.c[s.i++]=s={t:1,d:!1,i:0,c:{}}),s.d))return null;if(s.d=!0,1===n)o=l?o[i]:o[i]={};else if(0===n&&l)return null;return[i,o,s.c]}function y(e,t){let r=t?.maxDepth??1e3,c={},g={},m=c,w=g;for(let t=o(e,0);t<e.length;){if("["===e[t]){let r="["===e[++t],i=v(e,t+=+r,"]");if(r){if("]"!==e[i[1]-1])throw new n("expected end of table declaration",{toml:e,ptr:i[1]-1});i[1]++}let s=b(i[0],c,g,r?2:1);if(!s)throw new n("trying to redefine an already defined table or value",{toml:e,ptr:t});w=s[2],m=s[1],t=i[1]}else{let c=v(e,t),g=b(c[0],m,w,0);if(!g)throw new n("trying to redefine an already defined table or value",{toml:e,ptr:t});let y=function e(t,r,c,g){let m;if(0===g)throw new n("document contains excessively nested structures. aborting.",{toml:t,ptr:r});let w=t[r];if("["===w||"{"===w){let[o,l]="["===w?function(t,r,i){let o,a=[];for(r++;"]"!==(o=t[r++])&&o;)if(","===o)throw new n("expected value, found comma",{toml:t,ptr:r-1});else if("#"===o)r=s(t,r);else if(" "!==o&&"	"!==o&&"\n"!==o&&"\r"!==o){let n=e(t,r-1,"]",i-1);a.push(n[0]),r=n[1]}if(!o)throw new n("unfinished array encountered",{toml:t,ptr:r});return[a,r]}(t,r,g):function(t,r,i){let s,o={},a=new Set,l=0;for(r++;"}"!==(s=t[r++])&&s;)if("\n"===s)throw new n("newlines are not allowed in inline tables",{toml:t,ptr:r-1});else if("#"===s)throw new n("inline tables cannot contain comments",{toml:t,ptr:r-1});else if(","===s)throw new n("expected key-value, found comma",{toml:t,ptr:r-1});else if(" "!==s&&"	"!==s){let s,c=o,u=!1,[h,d]=v(t,r-1);for(let e=0;e<h.length;e++){if(e&&(c=u?c[s]:c[s]={}),(u=Object.hasOwn(c,s=h[e]))&&("object"!=typeof c[s]||a.has(c[s])))throw new n("trying to redefine an already defined value",{toml:t,ptr:r});u||"__proto__"!==s||Object.defineProperty(c,s,{enumerable:!0,configurable:!0,writable:!0})}if(u)throw new n("trying to redefine an already defined value",{toml:t,ptr:r});let[f,g]=e(t,d,"}",i-1);a.add(f),c[s]=f,l=","===t[(r=g)-1]?r-1:0}if(l)throw new n("trailing commas are not allowed in inline tables",{toml:t,ptr:l});if(!s)throw new n("unfinished table encountered",{toml:t,ptr:r});return[o,r]}(t,r,g),u=a(t,l,",",c);if("}"===c){let e=i(t,l,u);if(e>-1)throw new n("newlines are not allowed in inline tables",{toml:t,ptr:e})}return[o,u]}if('"'===w||"'"===w){m=l(t,r);let e=p(t,r,m);if(c){if(m=o(t,m,"]"!==c),t[m]&&","!==t[m]&&t[m]!==c&&"\n"!==t[m]&&"\r"!==t[m])throw new n("unexpected character encountered",{toml:t,ptr:m});m+=+(","===t[m])}return[e,m]}m=a(t,r,",",c);let b=function(e,t,r,i){let o=e.slice(t,r),a=o.indexOf("#");a>-1&&(s(e,a),o=o.slice(0,a));let l=o.trimEnd();if(!i){let r=o.indexOf("\n",l.length);if(r>-1)throw new n("newlines are not allowed in inline tables",{toml:e,ptr:t+r})}return[l,a]}(t,r,m-(","===t[m-1]),"]"===c);if(!b[0])throw new n("incomplete key-value declaration: no value specified",{toml:t,ptr:r});return c&&b[1]>-1&&(m=o(t,r+b[1]),m+=+(","===t[m])),[function(e,t,r){let i;if("true"===e)return!0;if("false"===e)return!1;if("-inf"===e)return-1/0;if("inf"===e||"+inf"===e)return 1/0;if("nan"===e||"+nan"===e||"-nan"===e)return NaN;if("-0"===e)return 0;if((i=h.test(e))||d.test(e)){if(f.test(e))throw new n("leading zeroes are not allowed",{toml:t,ptr:r});let s=+e.replace(/_/g,"");if(isNaN(s))throw new n("invalid number",{toml:t,ptr:r});if(i&&!Number.isSafeInteger(s))throw new n("integer value cannot be represented losslessly",{toml:t,ptr:r});return s}let s=new u(e);if(!s.isValid())throw new n("invalid value",{toml:t,ptr:r});return s}(b[0],t,r),m]}(e,c[1],void 0,r);g[1][g[0]]=y[0],t=y[1]}if(t=o(e,t,!0),e[t]&&"\n"!==e[t]&&"\r"!==e[t])throw new n("each key-value declaration must be followed by an end-of-line",{toml:e,ptr:t});t=o(e,t)}return c}let k=/^[a-z0-9-_]+$/i;function O(e){let t=typeof e;if("object"===t){if(Array.isArray(e))return"array";if(e instanceof Date)return"date"}return t}function S(e){return JSON.stringify(e).replace(/\x7f/g,"\\u007f")}},98810:e=>{e.exports=(e={})=>{let t=s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAAAQCAYAAAAoEfIQAAAAAXNSR0IArs4c6QAAActJREFUaIHtmttuwyAMQEm1//9l9kTEHGyMb4HVR6rSJYAdX8CDlpIkSZIkSbITFXxO5WTdT8fd9pe3AANqidWzGR3KxO7DNhpde4dj8mc6aPtYEO0zS0ZJJ3mXENvvbuQVI6zOdqPxOIE3a6MJXgv5fTvI7v5+m2ZbGHerPtXYHpM1vP+zoMCqEpr+UrT6WemwwwrU5EfqwrGrNpAlaMda9anG9iNZ6DhYAltAlYAcYHvvQOSOz3GmNIm58iksKgTpBGxVJXlMsJIEhPciJsMKrv39h+yPszLfDCzFItAmSNuwowKYI0Pz3hV8l2wkYv0i/DHSlfsO2D7LBZ7feK7AGqgAe7s0XSGynKYCdWRPdpnWEVGW9xPfqIqTVCCcDUgLqMlv1obrvz/9d03g/0RUEmOBP0pU2Ibq3xOVCB7VS9QmlKbP7L0fzz0TWOMA7EU8A4ebaFYbE9KxqTbcwKf6Nxkrcrms9Lf09UlVWynzFfoGS+BIR1FjvHWO6UHkSqx5zm0zYzaReJ1lnxo3V3etyPf++vzjcCzOgftxvP6PopLY8occeQ4sY1bCavpzx2CTDsWBjjjRVrutRKdtQibJ60QfZSVJkiQcfgHLRY8eT2qnRAAAAABJRU5ErkJggg=="),r=s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJgAAAAoCAYAAAACCDNUAAAAAXNSR0IArs4c6QAABuJJREFUeJztXNGO3DAIjKv7/192X0KOkBkY7Oy1qop06sYYPAYMOHfbcYg05zzGGPP8PMYYcPw4jvSZ6UBykcYY11zAuxhu3RK/5wOs2R5vcozYvLj+TxGztbdfGC9tk8n/+tRGFJpzQoBjjGnP/rOfG+effGasEgfSE+bEw3LxEJ6IIRv/KaqCa845mA0z3Jn81+u7IIujzyzjKfr8XMuMkXdmHiqX6fUZxk6xXydbP2JA5Jyd7lfNkBU1qgRc0FcfxIvyNvZKgEWwyPjoc5xDHETBm+OjHFvD6Un3g/isPDOjoz2zfVSkODajJHM9MjHBm7Umqf7tABNOUJnBPCjjRT4Jmocj0bxuv+Mznx8jc9MeBs0hJfj2HPrH2shEPnM+20uHKv2tAFsEUGYwdEKLzAUdlaVxFacFtg+yqrwgfC4b3HQ4mQeG3cPRwCfrrEo8W9f4rQDrpnZB39XbIP2nIdI1UeZCGVDFwWQzJ2UtgjiuwFwiNXOxFsXrYDrZvDmnHsrKCVTkmI4qxdtY1xk7p7WTfXYolvqVNVT7KbJ+/m7w+9uW/B7E+KjJjjp25S+gSY+T8dUgUfkhUyLYD7ki+6X4ES/qqpr4qgXprq/ot3mmpOxxYPoLC2QlifUX6IRUPVfn2QdYFhwZv3KgQizISABKPat6AF+2p4TH6IsxmHGyJrqq4WidrEz+DZQFl5GSwYtLxNbrChQQnR4U4c54qv5hrylQqsuymZsDAVWNsskEI9/meNmqCUV8RJVBGL/qjxRDs0uEsv+3iNkvYvXUOfRIv2Ww2yAKkOi8lRNSnbCqh0Dy3nkM6y5l2SdbzzCpwVMFckXqAcsy0E4VoSWyyFJpEFTyq9Q1roKl62DDsVPilBLr5t7WzfhkrVvVWaUdGwY83z0YK0FZj4SMH+Ur/Qop8hX2Qn/KV0pcplvNTGp74Ma3SxhbQwmuuD7EeH5ggI4gAPmVvKKf6V7Vr2I3nphh0jUQqTJd29qcnZKm+GfVt9e889+t91CoR0LPSD8KBC+vlOQw/7FMJq+WfGX/jP8n5P0c1T/EnjfbKv7xOm5/D3b2FtdPnOzHO3U+6ovPHVrt90yO4c72o+6f8T8t/6Z9u1ThTX8XyVJkBzxLpStNfNUDqPIZ/6ccs0PoMrBSYhfWpXhYD3fLYDapOs1sTiW7Q2qjzMjkWAC9cQPz+18JVCbvsX3Sxgo+MHYcB8XLSyRbpOJ1DXvezq6fal3ngM4yNx2rfEV/KGNt+YbuHw0y1mKYH0iJfP5N/hjj+nmDWOD4cfVUKkGWBax469vaeGW/KsOxnuaTARUzJMPHMGc9ovSlDwSgQ1GO1WulxGQn2JeQRZxwvIOvkl+9JL21Pms1WImLY+y2yEq6ivE//adlmsdxTFBarnH7HH+sBKE5rjzd9EMAufwNU9Wr0U2GPak6gC22aEVf9ElXVpFR5qE5ldyXv2KCHidNiwTEiM9e/5zPL1R4uaqJrPRkxLAwgxKcD34lXwVDJh/3T3qjVD+bG/EpZVe4KN2e5d9FKhuNwL2uLMgER01FT0bmLHSg/BoeM7gkxJebkGd8vyd2KBnf6yc3tFJ/lhii/ZDvEYn+v+b8Upo8FlyKc6P+7msGlk13mvgJXqfYWKaf8eMtijkW8RifOXxFf4U/rrFD0V+3PzgME21hKNgpTyx7KBkoZJlLj7w4wBL02/grN56d1zvkZkx98xZlbUJTzyNGpK+tkavoBS4S4mUlKttc1P+2cU+d0TDL1kY9TkN2aXOoxdmlzL8KDksgS9+L9ArZHMJ7BNlxHFtOrU6eYiDVQVnZYj2sop/Jd52LcK5QKLkt2Rhkj4zkFoHjAEzrFhZ1rshHdQVfuRkp6zwVv3CLVPaflcg5ta+lZesLGGFikUvrXHzH8q+Q3/+/uvdZvEtjNkAyFd89f5dIS20IGKMqgpUTviNf0ar8p4JM2e/ba4c+uHzFgMj3puz1TizzVuLpLZKBQvU5udI/9CD+ijzC9IY86qMyG1TPyKmMn9zYpefKBp7U/o4dUvf8eL3lSW7y4yZiJPsFYqQjg+zKI4yqPJJbPd0dQs5+NMULOFjwxrGu3gyre05l5P9C04B90gFv0QwvHGPghYz1kB8v/8mS01sejPCs6Hzoj/LeHjs3zJBtJePQDObS9SqeNq1e84OO27PtI55olEGjjEoInz+QnqeUTMPmsbP9s7JqvKrEVf7dLbEwwFiaXs1emQMy/d44LOUrpFzjO0ESMRo+lEHCjWuMZ/a8yYCSWe6/6iHZHlV/7pRY+h6MLNQ+3cUF4vYeR6npcT7SGedn2Kp51Z5ZhmDjmW60VrSRw9t6z8WwrODvVLXf5k4SBfyDXswAAAAASUVORK5CYII="),n={};r.onload=()=>{let e=r.width/8;" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~".split("").forEach((t,r)=>{n[t]=[~~(r%e),~~(r/e)]})};let i={pen:{cursor:"crosshair",key:"q",icon:0},erasor:{cursor:"crosshair",key:"w",icon:1},bucket:{cursor:"crosshair",key:"e",icon:2},rect:{cursor:"crosshair",key:"a",icon:3},circle:{cursor:"crosshair",key:"s",icon:4},line:{cursor:"crosshair",key:"d",icon:5},select:{cursor:"cell",key:"z",icon:6},move:{cursor:"move",key:"x",icon:7},eyedropper:{cursor:"crosshair",key:"c",icon:8}};function s(e,t){let r=new window.Image;return r.src=e,t&&(r.onload=()=>{t(r)}),r}function o(e,t,r){return Math.max(Math.min(e,r),t)}let a=(e,t)=>{let r=document.createElement("canvas"),n=(()=>{if(e instanceof window.ImageData)return new window.ImageData(new Uint8ClampedArray(e.data),e.width,e.height);if(!(e instanceof window.Image))return new window.ImageData(new Uint8ClampedArray(e*t*4).fill(0),e,t);{r.width=e.width,r.height=e.height;let t=r.getContext("2d");return t.drawImage(e,0,0),t.getImageData(0,0,e.width,e.height)}})();function i(){r.width=n.width,r.height=n.height,r.getContext("2d").putImageData(n,0,0)}function s(e,t){return(t*n.width+e)*4}return{blend:"alpha",scissorRect:null,width:()=>n.width,height:()=>n.height,toImageData:()=>new window.ImageData(new Uint8ClampedArray(n.data),n.width,n.height),clone(){return a(this.toImageData())},clear(){n=new window.ImageData(new Uint8ClampedArray(n.width*n.height*4).fill(0),n.width,n.height)},set(e,t,r){if(!this.checkPt(e,t))return!1;let i=s(e,t);switch(this.blend){case"alpha":{let e=r[3]/255;n.data[i+0]=n.data[i+0]*(1-e)+r[0]*e,n.data[i+1]=n.data[i+1]*(1-e)+r[1]*e,n.data[i+2]=n.data[i+2]*(1-e)+r[2]*e,n.data[i+3]=n.data[i+3]*(1-e)+r[3]*e;break}case"replace":n.data[i+0]=r[0],n.data[i+1]=r[1],n.data[i+2]=r[2],n.data[i+3]=r[3];break;case"add":{let e=n.data[i+3]/255,t=r[3]/255;n.data[i+0]=n.data[i+0]*e+r[0]*t,n.data[i+1]=n.data[i+1]*e+r[1]*t,n.data[i+2]=n.data[i+2]*e+r[2]*t,n.data[i+3]=n.data[i+3]*e+r[3]*t}}return!0},get(e,t){let r=s(e,t),i=n.data[r+0],o=n.data[r+1];return[i,o,n.data[r+2],n.data[r+3]]},line(e,t,r,n,i){let s=r-e,o=n-t,a=Math.abs(s),l=Math.abs(o),c=0,u=s>0?1:-1,h=o>0?1:-1;if(a>l)for(let n=e,s=t;u<0?n>=r:n<=r;n+=u)this.set(n,s,i),(c+=l)<<1>=a&&(s+=h,c-=a);else for(let r=e,s=t;h<0?s>=n:s<=n;s+=h)this.set(r,s,i),(c+=a)<<1>=l&&(r+=u,c-=l)},fillRect(e,t,r,n,i){r<0&&(e+=r,r=-r),n<0&&(t+=n,n=-n);for(let s=e;s<e+r;s++)for(let e=t;e<t+n;e++)this.set(s,e,i)},strokeRect(e,t,r,n,i){r<0&&(e+=r,r=-r),n<0&&(t+=n,n=-n),this.line(e,t,e+r,t,i),this.line(e+r,t,e+r,t+n,i),this.line(e+r,t+n,e,t+n,i),this.line(e,t+n,e,t,i)},fillCircle(e,t,r,n){r=Math.abs(r);for(let i=e-r;i<=e+r;i++)for(let s=t-r;s<=t+r;s++)Math.sqrt((i-e)**2+(s-t)**2)<=r&&this.set(i,s,n)},bucket(e,t,r){if(!this.checkPt(e,t))return!1;let n=this.get(e,t);if(l(n,r))return!1;let i=[];for(i.push([e,t]);i.length;){let[e,t]=i.pop();this.checkPt(e,t)&&l(this.get(e,t),n)&&(this.set(e,t,r),i.push([e,t-1]),i.push([e-1,t]),i.push([e+1,t]),i.push([e,t+1]))}return!0},merge(e,t=0,r=0){for(let i=0;i<n.width;i++)for(let s=0;s<n.height;s++){let o=e.get(i,s);o&&i+t>=0&&i+t<n.width&&s+r>=0&&s+r<n.height&&this.set(i+t,s+r,o)}},checkPt(e,t){if(this.scissorRect){let r=this.scissorRect;return e>=r[0][0]&&e<r[1][0]&&t>=r[0][1]&&t<r[1][1]}return e>=0&&e<n.width&&t>=0&&t<n.height},clampPt:e=>[o(e[0],0,n.width),o(e[1],0,n.height)],bbox(){let e=[0,0],t=[n.width-1,n.height-1];e:for(let r=e[0];r<=t[0];r++)for(let i=e[1];i<=t[1];i++){let t=s(r,i);if(0!==n.data[t+3]){e[0]=r;break e}}e:for(let r=t[0];r>=e[0];r--)for(let i=e[1];i<=t[1];i++){let e=s(r,i);if(0!==n.data[e+3]){t[0]=r;break e}}t:for(let r=e[1];r<=t[1];r++)for(let i=e[0];i<=t[0];i++){let t=s(i,r);if(0!==n.data[t+3]){e[1]=r;break t}}t:for(let r=t[1];r>=e[1];r--)for(let i=e[0];i<=t[0];i++){let e=s(i,r);if(0!==n.data[e+3]){t[1]=r;break t}}return[e,t]},crop(e,t){let r=a(t[0]-e[0]+1,t[1]-e[1]+1);for(let n=e[0];n<=t[0];n++)for(let i=e[1];i<=t[1];i++)r.set(n-e[0],i-e[1],this.get(n,i));n=r.toImageData()},toDataURL:()=>(i(),r.toDataURL("image/png")),toPNG(){let e=this.toDataURL().replace(/^data:image\/png;base64,/,""),t=window.atob(e),r=new Uint8Array(t.length);for(let e=0;e<r.length;e++)r[e]=t.charCodeAt(e);return r.buffer},drawable:()=>(i(),r),game(){let e=this.toImageData();for(let t=0;t<n.height;t++)for(let r=0;r<n.width;r++){let i=0,s=0,o=0,a=0;for(let e=-1;e<=1;e++)for(let l=-1;l<=1;l++)if((0!==e||0!==l)&&r-e>=0&&r+e<n.width&&t-l>=0&&t+l<n.height){let c=((t+l)*n.width+r+e)*4;n.data[c+3]>0&&(s+=n.data[c+0],o+=n.data[c+1],a+=n.data[c+2],i++)}let l=(t*n.width+r)*4;i<2||i>3?(e.data[l+0]=0,e.data[l+1]=0,e.data[l+2]=0,e.data[l+3]=0):3===i&&(e.data[l+0]=s/i,e.data[l+1]=o/i,e.data[l+2]=a/i,e.data[l+3]=255)}return a(e)}}};function l(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function c(e){return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}function u(e){let t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t,255]}let h=Math.ceil(e.data?.width??e.width??64),d=Math.ceil(e.data?.height??e.height??64);if(h<=0)throw Error("Invalid width");if(d<=0)throw Error("Invalid height");let f=e.canvas,g=e.canvas.getContext("2d"),m={width:h,height:d,curFrame:0,frames:[a(h,d)],fCanvas:a(h,d),anims:{},tool:"pen",color:[0,0,0,255],palette:e.palette||[[0,0,0,255],[255,255,255,255],[255,255,128,255],[255,128,255,255],[0,128,128,255],[128,0,255,255],[255,0,128,255],[0,255,255,255]],view:{offset:[0,0],scale:1},state:{stack:[],offset:0},modified:!1,readOnly:e.readOnly,events:{},curAnim:null,animTimer:0,animSpeed:200,gaming:!1,gameTimer:0,gameSpeed:100},p={mouseDown:!1,mousePressed:!1,mouseMoved:!1,mousePos:[0,0],mousePosPrev:[0,0],mouseStartPos:null,grabbin:!1,delCb:()=>{},hideUI:!1,loopID:null,time:0};O(),g.imageSmoothingEnabled=!1;let w={game:{icon:14,action:function(){m.gaming=!0,m.readOnly=!0,M()}},export:{icon:13,action:()=>E("export")},save:{icon:12,action:()=>E("save")},crop:{icon:9,action:function(){let e,t;m.frames.forEach(r=>{let[n,i]=r.bbox();e&&t?(e[0]=Math.min(e[0],n[0]),e[1]=Math.min(e[1],n[0]),t[0]=Math.max(t[0],i[0]),t[1]=Math.max(t[1],i[0])):(e=n,t=i)}),m.frames.forEach(r=>r.crop(e,t)),m.width=N().width(),m.height=N().height(),M()}},undo:{icon:10,key:"shift+z",action:z},redo:{icon:11,key:"meta+shift+z",action:R}},v=document.createElement("input");function b(e){return[~~((e[0]-m.view.offset[0])/m.view.scale),~~((e[1]-m.view.offset[1])/m.view.scale)]}function y(){m.view.scale<=2||(m.view.scale--,m.view.offset[0]+=m.width/2,m.view.offset[1]+=m.height/2)}function k(){m.view.scale>=64||(m.view.scale++,m.view.offset[0]-=m.width/2,m.view.offset[1]-=m.height/2)}function O(){let e=f.width,t=f.height,r=(e-120)/m.width,n=(t-120)/m.height;m.view.scale=~~Math.min(r,n),m.view.offset=[(e-m.width*m.view.scale)/2,(t-m.height*m.view.scale)/2]}function S(e=m.curFrame){m.frames.splice(m.curFrame,0,N().clone()),e===m.curFrame&&P(m.curFrame+1),M()}function I(e=m.curFrame){m.frames.length>1&&(m.frames.splice(e,1),m.curFrame===m.frames.length&&P(m.frames.length-1)),M()}function P(e){m.curFrame=e,p.delCb=()=>{confirm(`removed frame ${e}?`)&&I(e)}}function D(e){"number"==typeof e?(m.color=m.palette[e],p.delCb=()=>{confirm("remove selected color?")&&(m.palette.splice(e,1),E("change",m.palette))}):m.color=e}function A(){P(0===m.curFrame?m.frames.length-1:m.curFrame-1)}function x(){P((m.curFrame+1)%m.frames.length)}function C(){let e=N(),[t,r]=e.scissorRect;e.blend="replace",e.fillRect(t[0],t[1],r[0]-t[0],r[1]-t[1],[0,0,0,0]),e.blend="alpha",M()}function E(e,...t){if(m.events[e])for(let r of m.events[e])r(...t)}function M(){m.state.stack.length>=64||(m.state.offset>0&&(m.state.stack.splice(m.state.stack.length-m.state.offset,m.state.offset),m.state.offset=0),m.state.stack.push({frames:j(),curFrame:m.curFrame}),E("change"))}function T(e){m.frames=e.frames.map(a),P(e.curFrame),E("change")}function z(){m.state.offset>=m.state.stack.length-1||(m.state.offset++,T(m.state.stack[m.state.stack.length-m.state.offset-1]))}function R(){0!==m.state.offset&&(m.state.offset--,T(m.state.stack[m.state.stack.length-m.state.offset-1]))}function j(){return m.frames.map(e=>e.toImageData())}function _(){m.curAnim=null,m.animTimer=0,m.readOnly=e.readOnly}function U(e,t){p.mousePressed=!0,p.mousePosPrev=[...p.mousePos],p.mousePos=[e,t],p.mouseStartPos=[...p.mousePos]}function F(e,t,r,n){if(m.readOnly||(p.mousePosPrev=[...p.mousePos],p.mousePos=[e,t],p.mouseMoved=!0,p.grabbin&&(m.view.offset[0]+=r,m.view.offset[1]+=n),!p.mouseDown))return;let i=N(),[s,o]=b(p.mousePos),[a,l]=b(p.mousePosPrev);if(!p.mouseStartPos)return;let[c,u]=b(p.mouseStartPos);switch(m.tool){case"pen":i.line(a,l,s,o,m.color);break;case"erasor":i.blend="replace",i.line(a,l,s,o,[0,0,0,0]),i.blend="alpha";break;case"rect":m.fCanvas.clear(),m.fCanvas.fillRect(c,u,s-c,o-u,m.color);break;case"line":m.fCanvas.clear(),m.fCanvas.line(c,u,s,o,m.color);break;case"circle":m.fCanvas.clear(),m.fCanvas.fillCircle(c,u,Math.max(s-c,o-u),m.color);break;case"select":{let[e,t]=i.clampPt([c,u]),[r,n]=i.clampPt([s,o]);i.scissorRect=[[e,t],[r,n]];break}case"move":{let[e,t]=[s-a,o-l];i.scissorRect[0][0]+=e,i.scissorRect[1][0]+=e,i.scissorRect[0][1]+=t,i.scissorRect[1][1]+=t}}}function L(e,t){if(m.readOnly)return;p.mouseDown=!1,p.mousePosPrev=[p.mousePos,p.mousePos],void 0!=e&&void 0!=t&&(p.mousePos=[e,t]);let r=N(),[n,i]=b(p.mousePos);if(!p.mouseStartPos)return;let[s,o]=b(p.mouseStartPos);switch(p.mouseStartPos=null,m.tool){case"pen":case"erasor":case"bucket":M();break;case"rect":case"circle":case"line":r.merge(m.fCanvas),m.fCanvas.clear(),M();break;case"move":if(r.scissorRect){let[e,t]=[n-s,i-o];r.merge(m.fCanvas,e,t),m.fCanvas.clear(),M()}}}v.type="color",v.addEventListener("change",e=>{let t=u(e.target.value.substring(1));m.palette.push(t),D(t),E("change",m.palette)}),p.loopID=window.requestAnimationFrame(function e(s){let o=s-p.time;if(p.time=s,m.gaming&&(m.gameTimer+=o,m.gameTimer>=m.gameSpeed&&(m.frames[m.curFrame]=N().game(),m.gameTimer=0)),m.curAnim&&(m.animTimer+=o,m.animTimer>=m.animSpeed)){let e=m.anims[m.curAnim];e.to<e.from?m.curFrame>e.to?A():P(e.from):m.curFrame<e.to?x():P(e.from),m.animTimer=0}let a=!1,h=!1,d=null,y=N(),k=f.width,O=f.height,I=m.view.scale,M=m.view.offset[0],T=m.view.offset[1];function z(e,t,r={}){let n,i=r.lineWidth||2;return{width:e,height:t,update(){n&&(r.click||r.hover)&&function(e,t,r,n){r<0&&(e+=r,r=-r),n<0&&(t+=n,n=-n);let[i,s]=p.mousePos;return i>=e&&i<=e+r&&s>=t&&s<=t+n}(n.x,n.y,e,t)&&(a=!0,r.hover&&r.hover(),p.mousePressed&&!h&&(r.click&&r.click(),h=!0))},draw(){n=g.getTransform().transformPoint(),this.update(),r.bg&&(g.fillStyle=c(r.bg),g.fillRect(0,0,e,t)),r.border&&(g.lineWidth=i,g.strokeStyle=c(r.border),g.strokeRect(0,0,e,t))}}}function R(e,t={}){let r=t.align||"left",n=t.margin||0,i=t.padding||0,s=0,o=0;for(let t of e)t&&(s=Math.max(t.width,s),o+=t.height+n);let a=s+2*i,l=o+2*i,c=z(a,l,t);return{width:a,height:l,update(){e.reverse().forEach(e=>{e.update()})},draw(){c.draw(),g.save(),g.translate(i,i),e.forEach(e=>{if(!e)return;let t=(()=>{switch(r){case"left":return 0;case"center":return(s-e.width)/2;case"left":return s-e.width}})();g.translate(t,0),e.draw(),g.translate(-t,e.height+n)}),g.restore()}}}function j(e,t={}){let r=t.align||"top",n=t.margin||0,i=t.padding||0,s=0,o=0;for(let t of e)t&&(s+=t.width,o=Math.max(t.height,o));let a=s+2*i,l=o+2*i,c=z(a,l,t);return{width:a,height:l,update(){e.reverse().forEach(e=>{e.update()})},draw(){c.draw(),g.save(),g.translate(i,i),e.forEach(e=>{if(!e)return;let t=(()=>{switch(r){case"top":return 0;case"center":return(o-2*i-e.height)/2;case"bottom":return o-2*i-e.height}})();g.translate(0,t),e.draw(),g.translate(e.width+n,-t)}),g.restore()}}}function U(e,t={}){let r=t.padding||0,n=t.sw||e.width,i=t.sh||e.height,s=(t.width||n)+2*r,o=(t.height||i)+2*r,a=s+2*r,l=o+2*r,c=t.sx||0,u=t.sy||0;t.lineWidth;let h=z(a,l,t);return{width:a,height:l,update(){h.update()},draw(){h.draw(),g.drawImage(e,c,u,n,i,r,r,s,o)}}}function F(e,t={}){e+="";let i=t.size||12,s=t.padding||0,o=e.length*i+2*s,a=i+2*s,l=t.color||[0,0,0,255];t.lineWidth;let u=z(o,a,t);return{width:o,height:a,update(){u.update()},draw(){u.draw(),g.fillStyle=c(l);let t=e.split(""),o=0;for(let e of t)if(n[e]){let[t,a]=n[e];g.drawImage(r,8*t,8*a,8,8,s+o,s,i,i),o+=i}}}}function L(e,t,r){t||r?(function(e,t,r,n={}){return{width:r.width,height:r.height,update(){r.update()},draw(){g.save(),g.translate(e,t),r.draw(),g.restore()}}})(t,r,e).draw():e.draw()}function Y(e,t,r,n={}){let i=z(e,t,n);return{width:e,height:t,update(){r.reverse().forEach(([e])=>{e.update()})},draw(){i.draw(),r.forEach(([e,[t,r]])=>{g.save(),g.translate(t,r),e.draw(),g.restore()})}}}let K=z(k,O,{bg:[170,170,170,255]}),V=j([...m.frames.map((e,t)=>{let r=t===m.curFrame;return F(t,{padding:r?6:3,bg:r?[255,255,255,255]:[230,230,230,255],border:[0,0,0,255],size:16,click(){P(t)}})}),!m.readOnly&&F("+",{padding:3,bg:[230,230,230,255],border:[0,0,0,255],size:16,click(){S()}})],{align:"bottom"}),H=z(y.width()*I,y.height()*I,{bg:[255,255,255,255]}),W=z(y.width()*I,y.height()*I,{border:[0,0,0,255]});function B(e,t={}){let r=t.dx||0,n=t.dy||0;return{width:e.width()*I,height:e.height()*I,draw(){g.save(),g.scale(I,I),g.translate(r,n),g.drawImage(e.drawable(),0,0),g.restore()}}}if(Y(k,O,[[K,[0,0]],[H,[M,T]],[B(y),[M,T]],[(()=>{if("move"!==m.tool||!p.mouseStartPos)return B(m.fCanvas);{let[e,t]=b(p.mousePos),[r,n]=b(p.mouseStartPos),[i,s]=[e-r,t-n];return B(m.fCanvas,{dx:i,dy:s})}})(),[M,T]],[V,[M,T-V.height]],[W,[M,T]]]).draw(),y.scissorRect){let e=y.scissorRect[0],t=y.scissorRect[1];g.lineDashOffset=s/100,g.strokeStyle=c([0,0,0,255]),g.setLineDash([5,5]),g.strokeRect(e[0]*I+M,e[1]*I+T,(t[0]-e[0])*I,(t[1]-e[1])*I),g.strokeStyle=c([255,255,255,255]),g.setLineDash([0,5,5,0]),g.strokeRect(e[0]*I+M,e[1]*I+T,(t[0]-e[0])*I,(t[1]-e[1])*I),g.setLineDash([])}if(!m.readOnly){let[e,t]=b(p.mousePos),r=e*I+M,n=t*I+T;if(y.checkPt(e,t))switch(m.tool){case"pen":case"rect":case"line":case"circle":case"bucket":L(z(I,I,{bg:m.color}),r,n);break;case"erasor":L(z(I,I,{bg:[255,255,255,255],border:[0,0,0,255]}),r,n)}}let q={padding:3,size:16,bg:[255,255,255,255],border:[0,0,0,255]},J=R([...m.palette.map((e,t)=>z(24,24,{bg:e,border:[0,0,0,255],lineWidth:l(e,m.color)?4:2,click(){D(t)}})),F("+",{size:24,bg:[255,255,255,255],border:[0,0,0,255],click(){if(navigator.userAgent.match(/safari/i)){let e=prompt("Enter hex code for new color:");if(e?.length===6||e?.length===7){let t=u(e.startsWith("#")?e.substring(1):e);m.palette.push(t),D(m.palette.length-1),E("change",m.palette)}}else v.click()}})]),G=R([...Object.keys(i).map(e=>{let r=i[e];return U(t,{sx:16*r.icon,sw:16,sh:16,width:32,height:32,bg:[255,255,255,255],border:[0,0,0,255],lineWidth:m.tool===e?4:2,click(){m.tool=e},hover(){d={msg:`${e} (${r.key})`,pos:[-1,1]}}})})]),X=j([...Object.keys(w).map(e=>{let r=w[e];return U(t,{sx:16*r.icon,sw:16,sh:16,width:32,height:32,bg:[255,255,255,255],border:[0,0,0,255],click(){r.action()},hover(){d={msg:`${e}`,pos:[-1,-1]}}})})]),Q=R([!m.readOnly&&F("+",{...q,click(){let e=prompt("add anim:");e&&(m.anims[e]={from:0,to:0,loop:!0},E("change"))}}),...Object.keys(m.anims).map(e=>{let t=m.anims[e],r=e===m.curAnim;return j([F((r?">":"")+e,{...q,lineWidth:r?4:2,click(){m.curAnim?_():(m.curAnim=e,m.animTimer=0,P(m.anims[e].from),m.readOnly=!0)}}),F(t.from,{...q,lineWidth:r?4:2,click(){t.from=(t.from+1)%m.frames.length,E("change")}}),F(t.to,{...q,lineWidth:r?4:2,click(){t.to=(t.to+1)%m.frames.length,E("change")}})])})]);if(p.hideUI||(function(e,t,r,n={}){return Y(e,t,r.filter(e=>e).map(([r,n])=>[r,[n[0]*(e-r.width),n[1]*(t-r.height)]]),n)})(k,O,[!m.readOnly&&[J,[0,0]],!m.readOnly&&[G,[1,0]],!m.readOnly&&[X,[1,1]],[Q,[0,1]]]).draw(),d){let[e,t]=p.mousePos,r=F(d.msg,{padding:3,bg:[255,255,255,255],border:[0,0,0,255]}),n=r.width*(d.pos[0]-1)/2+6*d.pos[0],i=r.height*(d.pos[1]-1)/2+6*d.pos[1];L(r,e+n,t+i)}if(a?f.style.cursor="pointer":p.grabbin?f.style.cursor="grab":f.style.cursor=i[m.tool].cursor,p.mousePressed&&!h){let[e,t]=b(p.mousePos);if(p.mouseDown=!0,!m.readOnly)switch(m.tool){case"pen":y.set(e,t,m.color);break;case"erasor":y.blend="replace",y.set(e,t,[0,0,0,0]),y.blend="alpha";break;case"bucket":y.bucket(e,t,m.color);break;case"move":y.scissorRect&&(m.fCanvas.scissorRect=y.scissorRect,m.fCanvas.merge(y),m.fCanvas.scissorRect=null,C());break;case"eyedropper":m.color=y.get(e,t)}}p.mousePressed=!1,p.loopID=window.requestAnimationFrame(e)});let Y={wheel(e){e.preventDefault(),e.altKey?e.deltaY<0?k():e.deltaY>0&&y():(m.view.offset[0]-=e.deltaX,m.view.offset[1]-=e.deltaY)},mousedown(e){U(e.offsetX,e.offsetY)},mousemove(e){F(e.offsetX,e.offsetY,e.movementX,e.movementY)},mouseup(e){L(e.offsetX,e.offsetY)},touchstart(e){e.preventDefault();let t=e.touches[0];U(t.clientX,t.clientY)},touchmove(e){let t=e.touches[0];F(t.clientX,t.clientY,t.movementX,t.movementY)},touchend(e){let t=e.touches[0];L(t?.clientX,t?.clientY)},touchcancel(e){let t=e.touches[0];L(t?.clientX,t?.clientY)},keydown(t){if(!t.metaKey){for(let e in i)if(i[e].key===t.key){m.tool=e;return}}let r=N();switch(t.key){case"-":y();break;case"=":k();break;case"0":O();break;case"ArrowLeft":A();break;case"ArrowRight":x();break;case" ":p.grabbin=!0,t.preventDefault();break;case"Escape":_(),m.gaming=!1,m.gameTimer=0,m.readOnly=e.readOnly,z()}if(!m.readOnly)switch(t.key){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{let e=parseInt(t.key,10)-1;m.palette[e]&&D(e);break}case"+":S();break;case"_":I();break;case"z":t.metaKey&&(t.preventDefault(),t.shiftKey?R():z());break;case"s":t.metaKey&&(t.preventDefault(),E("save"));break;case"l":t.metaKey&&(t.preventDefault(),E("load"));break;case"Backspace":r.scissorRect?(C(),r.scissorRect=null):p.delCb();break;case"Escape":r.scissorRect=null;break;case"Tab":t.preventDefault(),p.hideUI=!p.hideUI}},keyup(e){" "===e.key&&(p.grabbin=!1)}};for(let e in f.onselectstart=()=>!1,Y)f.addEventListener(e,Y[e]);function N(){return m.frames[m.curFrame]}function K(){return{version:"1",width:m.width,height:m.height,palette:m.palette,anims:m.anims,frames:m.frames.map(e=>e.toDataURL())}}function V(e){if(!e.width||!e.height)throw Error("Expected width and height from load data");return(null===m.width||void 0===m.width)&&(m.width=e.width),(null===m.height||void 0===m.height)&&(m.height=e.height),m.fCanvas=a(e.width,e.height),O(),(null===m.palette||void 0===m.palette)&&(m.palette=e.palette),(null===m.anims||void 0===m.anims)&&(m.anims=e.anims),e.frames?Promise.all(e.frames.map((t,r)=>(function(e){let t=new Image;return t.src=e,new Promise((e,r)=>{t.onload=()=>{e(t)},t.onerror=()=>{r()}})})(t).then(e=>a(e)).then(t=>{if(t.width()!==e.width||t.height()!==e.height)throw Error("Frame size doesn't match actual size");m.frames[r]=t}))).then(()=>{m.frames.length=e.frames.length,m.curFrame>=m.frames.length&&P(m.frames.length-1)}):Promise.resolve()}function H(e,...t){let r=URL.createObjectURL(new Blob(...t)),n=document.createElement("a");n.href=r,n.download=e,n.click()}return m.state.stack=[{frames:j(),curFrame:m.curFrame}],e.data&&V(e.data),{frames:function(){return m.frames},curFrame:N,on:function(e,t){m.events[e]||(m.events[e]=[]),m.events[e].push(t)},setTool:function(e){if(!i[e])throw Error(`no tool called ${e} bro`);m.tool=e},setColor:D,setPalette:function(e){m.palette=e},save:K,load:V,undo:z,redo:R,pushState:M,scaleUp:k,scaleDown:y,scaleFit:O,newFrame:S,delFrame:I,prevFrame:A,nextFrame:x,download:function(e){H(e,[JSON.stringify(K())])},downloadPNG:function(e){H(e,[N().toPNG()])},cleanUp:function(){for(let e in Y)f.removeEventListener(e,Y[e]);window.cancelAnimationFrame(p.loopID)}}}}}]);
//# sourceMappingURL=3272-cab196c017755ab1.js.map